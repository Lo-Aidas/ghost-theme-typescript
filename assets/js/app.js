var GoogleCustomSearch=function(e){var t=this,n="https://www.googleapis.com/customsearch/v1",a=10,o=$.extend({form:".searchform",input:".searchform .search_input",modal:"#modal-search",overlay:"#modal-search .overlay",resultContainer:"#modal-search .results",closeButton:"#modal-search .close",nextButton:"#modal-search .next",prevButton:"#modal-search .prev",metadata:"#modal-search .meta",ajaxContent:"#modal-search .ajax-content, #modal-search .loading",loadingBar:"#modal-search .loading .bar",errorContainer:"#modal-search .modal-footer .error"},e);t.config=o,t.searchForm=$(o.form),t.searchInput=$(o.input),t.modal=$(o.modal),t.overlay=$(o.overlay),t.resultContainer=$(o.resultContainer),t.closeButton=$(o.closeButton),t.prevButton=$(o.prevButton),t.nextButton=$(o.nextButton),t.metadata=$(o.metadata),t.ajaxContent=$(o.ajaxContent),t.errorContainer=$(o.errorContainer),t.loadingBar=$(o.loadingBar),t.open=!1,t.queryText="",t.nav={next:-1,prev:-1,total:0,current:1},t.nextPage=function(){-1!==t.nav.next&&(o.onBeforeNextPage instanceof Function&&o.onBeforeNextPage.call(t),t.query(t.queryText,t.nav.next,function(e){o.onAfterNextPage instanceof Function&&o.onAfterNextPage.call(t,e)}))},t.prevPage=function(){-1!==t.nav.prev&&(o.onBeforePrevPage instanceof Function&&o.onBeforePrevPage.call(t),t.query(t.queryText,t.nav.prev,function(e){o.onAfterPrevPage instanceof Function&&o.onAfterPrevPage.call(t,e)}))},t.buildResults=function(e){var t="";return $.each(e,function(e,n){t+="<li>",t+="<a class='result' href='"+n.link+"'>",t+="<span class='title'>"+n.title+"</span>",t+="<span class='digest'>"+n.htmlSnippet.replace("<br>","")+"</span>",t+="<span class='icon icon-chevron-thin-right'></span>",t+="</a>",t+="</li>"}),t},t.buildMetadata=function(e){e.queries&&e.queries.request&&"0"!==e.queries.request[0].totalResults?(t.nav.current=e.queries.request[0].startIndex,t.nav.currentCount=e.queries.request[0].count,t.nav.total=parseInt(e.queries.request[0].totalResults),t.metadata.children(".total").html(t.nav.total),t.metadata.children(".range").html(t.nav.current+"-"+(t.nav.current+t.nav.currentCount-1)),t.metadata.show()):t.metadata.hide(),e.queries&&e.queries.nextPage?(t.nav.next=e.queries.nextPage[0].startIndex,t.nextButton.show()):(t.nav.next=-1,t.nextButton.hide()),e.queries&&e.queries.previousPage?(t.nav.prev=e.queries.previousPage[0].startIndex,t.prevButton.show()):(t.nav.prev=-1,t.prevButton.hide())},t.query=function(e,r,s){t.errorContainer.hide(),t.ajaxContent.removeClass("loaded"),$.get(n,{key:o.apiKey,cx:o.engineId,q:e,start:r,num:a},function(n,a){if(console.log(a),console.log(n),"success"===a&&n.items&&n.items.length>0){var o=t.buildResults(n.items);t.resultContainer.html(o)}else{var r="";r="success"===a?'No result found for "'+e+'".':"timeout"===a?"Unfortunate timeout.":"Mysterious failure.",t.resultContainer.html(""),t.errorContainer.html(r),t.errorContainer.show()}t.buildMetadata(n),t.ajaxContent.addClass("loaded"),s&&s(n)})},t.search=function(e){t.open||(t.modal.addClass("active"),$("body").addClass("modal-active")),t.searchInput.each(function(t,n){$(n).val(e)}),t.query(e,1)},t.close=function(){t.open=!1,t.modal.removeClass("active"),$("body").removeClass("modal-active")},t.init=function(){t.searchForm.each(function(e,n){$(n).on("submit",function(e){e.preventDefault(),t.queryText=$(this).children(".search_input").val(),t.search(t.queryText)})}),t.overlay.on("click",t.close),t.nextButton.on("click",t.nextPage),t.prevButton.on("click",t.prevPage),t.closeButton.on("click",t.close)},t.init()};!function(e){"use strict";var t="AIzaSyDGd5JJH7rR3sgS-JPYblwJ72GOsqzighc",n="017821029378163458527:msqkochcsj0",a={},o=!0,r={},s=function(t){t.preventDefault();var n=e(this),a=t.data&&t.data.correction?t.data.correction:0;e("html, body").animate({scrollTop:e(n.attr("href")).offset().top-a},400)},i=function(t){t.stopPropagation(),e("body").removeClass("menu-open"),e(".site-nav-switch").removeClass("active")},c=function(t){t.stopPropagation(),e("body").toggleClass("menu-open"),e(".site-nav-switch").toggleClass("active")},l=function(){var t=e(".single .content ul").length,n=e(".single .content ul li").length;e("#pixiv-vol").text(t),e("#pixiv-artist-count").text(n)},u=function(t){var n=this;n.init=function(){o&&e(t).each(function(){var t=e(this),n=t.find("h2.title > a").attr("href"),a=t.find("section.content"),o=t.find(".content-loading"),r=a.html(),s=/<!-- *more *-->(.|\n)*/i,i=r.replace(s,"");r.length!==i.length&&(i+="<a href='"+n+"' class='readmore'>Read More...</a>"),a.html(i),a.addClass("excerpt-ready"),o.addClass("excerpt-ready")})},n.init()};e(function(){e("#footer, #main").addClass("loaded"),e(".site-nav-switch").on("click",c),e(document).on("click",i),e(".site-menu").on("click",function(e){e.stopPropagation()}),e(".window-nav, .go-comment").on("click",s),setTimeout(function(){e("#loading-bar-wrapper").fadeOut(500)},300),e("body").hasClass("tag-pixiv")&&e("body").hasClass("page")&&l(),r=new u(".post-list .post"),a=new GoogleCustomSearch({apiKey:t,engineId:n})})}(jQuery);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdvb2dsZS1jdXN0b20tc2VhcmNoLmpzIiwiYXBwLmpzIl0sIm5hbWVzIjpbIkdvb2dsZUN1c3RvbVNlYXJjaCIsIm9wdGlvbnMiLCJzZWxmIiwidGhpcyIsIkdPT0dMRV9DVVNUT01fU0VBUkNIX0VORFBPSU5UIiwiUEVSX1BBR0UiLCJjb25maWciLCIkIiwiZXh0ZW5kIiwiZm9ybSIsImlucHV0IiwibW9kYWwiLCJvdmVybGF5IiwicmVzdWx0Q29udGFpbmVyIiwiY2xvc2VCdXR0b24iLCJuZXh0QnV0dG9uIiwicHJldkJ1dHRvbiIsIm1ldGFkYXRhIiwiYWpheENvbnRlbnQiLCJsb2FkaW5nQmFyIiwiZXJyb3JDb250YWluZXIiLCJzZWFyY2hGb3JtIiwic2VhcmNoSW5wdXQiLCJvcGVuIiwicXVlcnlUZXh0IiwibmF2IiwibmV4dCIsInByZXYiLCJ0b3RhbCIsImN1cnJlbnQiLCJuZXh0UGFnZSIsIm9uQmVmb3JlTmV4dFBhZ2UiLCJGdW5jdGlvbiIsImNhbGwiLCJxdWVyeSIsImRhdGEiLCJvbkFmdGVyTmV4dFBhZ2UiLCJwcmV2UGFnZSIsIm9uQmVmb3JlUHJldlBhZ2UiLCJvbkFmdGVyUHJldlBhZ2UiLCJidWlsZFJlc3VsdHMiLCJodG1sIiwiZWFjaCIsImluZGV4Iiwicm93IiwibGluayIsInRpdGxlIiwiaHRtbFNuaXBwZXQiLCJyZXBsYWNlIiwiYnVpbGRNZXRhZGF0YSIsInF1ZXJpZXMiLCJyZXF1ZXN0IiwidG90YWxSZXN1bHRzIiwic3RhcnRJbmRleCIsImN1cnJlbnRDb3VudCIsImNvdW50IiwicGFyc2VJbnQiLCJjaGlsZHJlbiIsInNob3ciLCJoaWRlIiwicHJldmlvdXNQYWdlIiwiY2FsbGJhY2siLCJyZW1vdmVDbGFzcyIsImdldCIsImtleSIsImFwaUtleSIsImN4IiwiZW5naW5lSWQiLCJxIiwic3RhcnQiLCJudW0iLCJzdGF0dXMiLCJjb25zb2xlIiwibG9nIiwiaXRlbXMiLCJsZW5ndGgiLCJyZXN1bHRzIiwiZXJyTXNnIiwiYWRkQ2xhc3MiLCJzZWFyY2giLCJlbGVtIiwidmFsIiwiY2xvc2UiLCJpbml0Iiwib24iLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwiR09PR0xFX0NVU1RPTV9TRUFSQ0hfQVBJX0tFWSIsIkdPT0dMRV9DVVNUT01fU0VBUkNIX0VOR0lORV9JRCIsImN1c3RvbVNlYXJjaCIsIkVYQ0VSUFRfR0VORVJBVE9SX0VOQUJMRSIsImV4Y2VycHRHZW5lcmF0b3IiLCJzY3JvbGx0b0VsZW1lbnQiLCJlIiwiY29ycmVjdGlvbiIsImFuaW1hdGUiLCJzY3JvbGxUb3AiLCJhdHRyIiwib2Zmc2V0IiwidG9wIiwiY2xvc2VNZW51Iiwic3RvcFByb3BhZ2F0aW9uIiwidG9nZ2xlTWVudSIsInRvZ2dsZUNsYXNzIiwicGl4aXZBcmNoaXZlU3RhdCIsInZvbCIsImFydGlzdENvdW50IiwidGV4dCIsIkV4Y2VycHRHZW5lcmF0b3IiLCJzZWxlY3RvciIsInBvc3QiLCJwZXJtYWxpbmsiLCJmaW5kIiwiY29udGVudFRhZyIsImNvbnRlbnRMb2FkaW5nVGFnIiwiY29udGVudCIsInJlIiwiZXhjZXJwdCIsImRvY3VtZW50Iiwic2V0VGltZW91dCIsImZhZGVPdXQiLCJoYXNDbGFzcyIsImpRdWVyeSJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBQUEsb0JBQUEsU0FBQUMsR0FDQSxHQUFBQyxHQUFBQyxLQUNBQyxFQUFBLDZDQUNBQyxFQUFBLEdBRUFDLEVBQUFDLEVBQUFDLFFBQ0FDLEtBQUEsY0FDQUMsTUFBQSw0QkFDQUMsTUFBQSxnQkFDQUMsUUFBQSx5QkFDQUMsZ0JBQUEseUJBQ0FDLFlBQUEsdUJBQ0FDLFdBQUEsc0JBQ0FDLFdBQUEsc0JBQ0FDLFNBQUEsc0JBQ0FDLFlBQUEsc0RBQ0FDLFdBQUEsOEJBQ0FDLGVBQUEsc0NBQ0FuQixFQUVBQyxHQUFBSSxPQUFBQSxFQUVBSixFQUFBbUIsV0FBQWQsRUFBQUQsRUFBQUcsTUFDQVAsRUFBQW9CLFlBQUFmLEVBQUFELEVBQUFJLE9BQ0FSLEVBQUFTLE1BQUFKLEVBQUFE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bkUsS0FBQSxXQUNBLEdBQUFvRSxHQUFBdkcsRUFBQUosTUFDQTRHLEVBQUFELEVBQUFFLEtBQUEsZ0JBQUFmLEtBQUEsUUFDQWdCLEVBQUFILEVBQUFFLEtBQUEsbUJBQ0FFLEVBQUFKLEVBQUFFLEtBQUEsb0JBQ0FHLEVBQUFGLEVBQUF4RSxPQUNBMkUsRUFBQSwwQkFDQUMsRUFBQUYsRUFBQW5FLFFBQUFvRSxFQUFBLEdBQ0FELEdBQUF4QyxTQUFBMEMsRUFBQTFDLFNBQ0EwQyxHQUFBLFlBQUFOLEVBQUEsdUNBRUFFLEVBQUF4RSxLQUFBNEUsR0FDQUosRUFBQW5DLFNBQUEsaUJBQ0FvQyxFQUFBcEMsU0FBQSxvQkFHQTVFLEVBQUFpRixPQUdBNUUsR0FBQSxXQUNBQSxFQUFBLGtCQUFBdUUsU0FBQSxVQUNBdkUsRUFBQSxvQkFBQTZFLEdBQUEsUUFBQWtCLEdBQ0EvRixFQUFBK0csVUFBQWxDLEdBQUEsUUFBQWdCLEdBQ0E3RixFQUFBLGNBQUE2RSxHQUFBLFFBQUEsU0FBQVMsR0FDQUEsRUFBQVEsb0JBRUE5RixFQUFBLDRCQUFBNkUsR0FBQSxRQUFBUSxHQUVBMkIsV0FBQSxXQUNBaEgsRUFBQSx3QkFBQWlILFFBQUEsTUFDQSxLQUVBakgsRUFBQSxRQUFBa0gsU0FBQSxjQUFBbEgsRUFBQSxRQUFBa0gsU0FBQSxTQUNBakIsSUFHQWIsRUFBQSxHQUFBaUIsR0FBQSxvQkFDQW5CLEVBQUEsR0FBQXpGLHFCQUNBaUUsT0FBQXNCLEVBQ0FwQixTQUFBcUIsT0FJQWtDIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBHb29nbGVDdXN0b21TZWFyY2ggPSBmdW5jdGlvbihvcHRpb25zKSB7XG4gIHZhciBzZWxmID0gdGhpcztcbiAgdmFyIEdPT0dMRV9DVVNUT01fU0VBUkNIX0VORFBPSU5UID0gXCJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9jdXN0b21zZWFyY2gvdjFcIjtcbiAgdmFyIFBFUl9QQUdFID0gMTA7IC8vIG11c3QgYmUgYmV0d2VlbiAxLTEwXG4gIFxuICB2YXIgY29uZmlnID0gJC5leHRlbmQoe1xuICAgIGZvcm06IFwiLnNlYXJjaGZvcm1cIixcbiAgICBpbnB1dDogXCIuc2VhcmNoZm9ybSAuc2VhcmNoX2lucHV0XCIsXG4gICAgbW9kYWw6IFwiI21vZGFsLXNlYXJjaFwiLFxuICAgIG92ZXJsYXk6IFwiI21vZGFsLXNlYXJjaCAub3ZlcmxheVwiLFxuICAgIHJlc3VsdENvbnRhaW5lcjogXCIjbW9kYWwtc2VhcmNoIC5yZXN1bHRzXCIsXG4gICAgY2xvc2VCdXR0b246IFwiI21vZGFsLXNlYXJjaCAuY2xvc2VcIixcbiAgICBuZXh0QnV0dG9uOiBcIiNtb2RhbC1zZWFyY2ggLm5leHRcIixcbiAgICBwcmV2QnV0dG9uOiBcIiNtb2RhbC1zZWFyY2ggLnByZXZcIixcbiAgICBtZXRhZGF0YTogXCIjbW9kYWwtc2VhcmNoIC5tZXRhXCIsXG4gICAgYWpheENvbnRlbnQ6IFwiI21vZGFsLXNlYXJjaCAuYWpheC1jb250ZW50LCAjbW9kYWwtc2VhcmNoIC5sb2FkaW5nXCIsXG4gICAgbG9hZGluZ0JhcjogXCIjbW9kYWwtc2VhcmNoIC5sb2FkaW5nIC5iYXJcIixcbiAgICBlcnJvckNvbnRhaW5lcjogXCIjbW9kYWwtc2VhcmNoIC5tb2RhbC1mb290ZXIgLmVycm9yXCJcbiAgfSwgb3B0aW9ucyk7XG4gIFxuICBzZWxmLmNvbmZpZyA9IGNvbmZpZztcbiAgXG4gIHNlbGYuc2VhcmNoRm9ybSA9ICQoY29uZmlnLmZvcm0pO1xuICBzZWxmLnNlYXJjaElucHV0ID0gJChjb25maWcuaW5wdXQpO1xuICBzZWxmLm1vZGFsID0gJChjb25maWcubW9kYWwpO1xuICBzZWxmLm92ZXJsYXkgPSAkKGNvbmZpZy5vdmVybGF5KTtcbiAgc2VsZi5yZXN1bHRDb250YWluZXIgPSAkKGNvbmZpZy5yZXN1bHRDb250YWluZXIpO1xuICBzZWxmLmNsb3NlQnV0dG9uID0gJChjb25maWcuY2xvc2VCdXR0b24pO1xuICBzZWxmLnByZXZCdXR0b24gPSAkKGNvbmZpZy5wcmV2QnV0dG9uKTtcbiAgc2VsZi5uZXh0QnV0dG9uID0gJChjb25maWcubmV4dEJ1dHRvbik7XG4gIHNlbGYubWV0YWRhdGEgPSAkKGNvbmZpZy5tZXRhZGF0YSk7XG4gIHNlbGYuYWpheENvbnRlbnQgPSAkKGNvbmZpZy5hamF4Q29udGVudCk7XG4gIHNlbGYuZXJyb3JDb250YWluZXIgPSAkKGNvbmZpZy5lcnJvckNvbnRhaW5lcik7XG4gIHNlbGYubG9hZGluZ0JhciA9ICQoY29uZmlnLmxvYWRpbmdCYXIpO1xuICBcbiAgc2VsZi5vcGVuID0gZmFsc2U7XG4gIHNlbGYucXVlcnlUZXh0ID0gXCJcIjtcbiAgc2VsZi5uYXYgPSB7XG4gICAgbmV4dDogLTEsXG4gICAgcHJldjogLTEsXG4gICAgdG90YWw6IDAsXG4gICAgY3VycmVudDogMVxuICB9O1xuICBcbiAgLyoqXG4gICAqIEZldGNoIG5leHQgcGFnZSBvZiByZXN1bHRzIChpZiBleGlzdHMpXG4gICAqIG5vIHBhcmFtXG4gICAqL1xuICBzZWxmLm5leHRQYWdlID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKHNlbGYubmF2Lm5leHQgIT09IC0xKSB7XG4gICAgICBpZiAoY29uZmlnLm9uQmVmb3JlTmV4dFBhZ2UgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xuICAgICAgICBjb25maWcub25CZWZvcmVOZXh0UGFnZS5jYWxsKHNlbGYpO1xuICAgICAgfVxuICAgICAgc2VsZi5xdWVyeShzZWxmLnF1ZXJ5VGV4dCwgc2VsZi5uYXYubmV4dCwgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICBpZiAoY29uZmlnLm9uQWZ0ZXJOZXh0UGFnZSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XG4gICAgICAgICAgY29uZmlnLm9uQWZ0ZXJOZXh0UGFnZS5jYWxsKHNlbGYsIGRhdGEpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG4gIFxuICAvKipcbiAgICogRmV0Y2ggcHJldmlvdXMgcGFnZSBvZiByZXN1bHRzIChpZiBleGlzdHMpXG4gICAqIG5vIHBhcmFtXG4gICAqL1xuICBzZWxmLnByZXZQYWdlID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKHNlbGYubmF2LnByZXYgIT09IC0xKSB7XG4gICAgICBpZiAoY29uZmlnLm9uQmVmb3JlUHJldlBhZ2UgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xuICAgICAgICBjb25maWcub25CZWZvcmVQcmV2UGFnZS5jYWxsKHNlbGYpO1xuICAgICAgfVxuICAgICAgc2VsZi5xdWVyeShzZWxmLnF1ZXJ5VGV4dCwgc2VsZi5uYXYucHJldiwgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICBpZiAoY29uZmlnLm9uQWZ0ZXJQcmV2UGFnZSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XG4gICAgICAgICAgY29uZmlnLm9uQWZ0ZXJQcmV2UGFnZS5jYWxsKHNlbGYsIGRhdGEpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG4gIFxuICAvKipcbiAgICogR2VuZXJhdGUgcmVzdWx0IGxpc3QgaHRtbFxuICAgKiBAcGFyYW0gZGF0YSA6IChhcnJheSkgcmVzdWx0IGl0ZW1zXG4gICAqL1xuICBzZWxmLmJ1aWxkUmVzdWx0cyA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICB2YXIgaHRtbCA9IFwiXCI7XG4gICAgJC5lYWNoKGRhdGEsIGZ1bmN0aW9uKGluZGV4LCByb3cpIHtcbiAgICAgIGh0bWwgKz0gXCI8bGk+XCI7XG4gICAgICBodG1sICs9ICAgXCI8YSBjbGFzcz0ncmVzdWx0JyBocmVmPSdcIiArcm93LmxpbmsrIFwiJz5cIjtcbiAgICAgIGh0bWwgKz0gICAgIFwiPHNwYW4gY2xhc3M9J3RpdGxlJz5cIiArcm93LnRpdGxlKyBcIjwvc3Bhbj5cIjtcbiAgICAgIGh0bWwgKz0gICAgIFwiPHNwYW4gY2xhc3M9J2RpZ2VzdCc+XCIgK3Jvdy5odG1sU25pcHBldC5yZXBsYWNlKCc8YnI+JywnJykrIFwiPC9zcGFuPlwiO1xuICAgICAgaHRtbCArPSAgICAgXCI8c3BhbiBjbGFzcz0naWNvbiBpY29uLWNoZXZyb24tdGhpbi1yaWdodCc+PC9zcGFuPlwiO1xuICAgICAgaHRtbCArPSAgIFwiPC9hPlwiO1xuICAgICAgaHRtbCArPSBcIjwvbGk+XCI7XG4gICAgfSk7XG4gICAgcmV0dXJuIGh0bWw7XG4gIH07XG4gIFxuICAvKipcbiAgICogR2VuZXJhdGUgbWV0YWRhdGEgYWZ0ZXIgYSBzdWNjZXNzZnVsIHF1ZXJ5XG4gICAqIEBwYXJhbSBkYXRhIDogKG9iamVjdCkgdGhlIHJhdyBnb29nbGUgY3VzdG9tIHNlYXJjaCByZXNwb25zZSBkYXRhXG4gICAqL1xuICBzZWxmLmJ1aWxkTWV0YWRhdGEgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgaWYgKGRhdGEucXVlcmllcyAmJiBkYXRhLnF1ZXJpZXMucmVxdWVzdCAmJiBkYXRhLnF1ZXJpZXMucmVxdWVzdFswXS50b3RhbFJlc3VsdHMgIT09ICcwJykge1xuICAgICAgc2VsZi5uYXYuY3VycmVudCA9IGRhdGEucXVlcmllcy5yZXF1ZXN0WzBdLnN0YXJ0SW5kZXg7XG4gICAgICBzZWxmLm5hdi5jdXJyZW50Q291bnQgPSBkYXRhLnF1ZXJpZXMucmVxdWVzdFswXS5jb3VudDtcbiAgICAgIHNlbGYubmF2LnRvdGFsID0gcGFyc2VJbnQoZGF0YS5xdWVyaWVzLnJlcXVlc3RbMF0udG90YWxSZXN1bHRzKTtcbiAgICAgIHNlbGYubWV0YWRhdGEuY2hpbGRyZW4oJy50b3RhbCcpLmh0bWwoc2VsZi5uYXYudG90YWwpO1xuICAgICAgc2VsZi5tZXRhZGF0YS5jaGlsZHJlbignLnJhbmdlJykuaHRtbChzZWxmLm5hdi5jdXJyZW50ICsgXCItXCIgKyAoc2VsZi5uYXYuY3VycmVudCtzZWxmLm5hdi5jdXJyZW50Q291bnQtMSkpO1xuICAgICAgc2VsZi5tZXRhZGF0YS5zaG93KCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgc2VsZi5tZXRhZGF0YS5oaWRlKCk7XG4gICAgfVxuICAgIGlmIChkYXRhLnF1ZXJpZXMgJiYgZGF0YS5xdWVyaWVzLm5leHRQYWdlKSB7XG4gICAgICBzZWxmLm5hdi5uZXh0ID0gZGF0YS5xdWVyaWVzLm5leHRQYWdlWzBdLnN0YXJ0SW5kZXg7XG4gICAgICBzZWxmLm5leHRCdXR0b24uc2hvdygpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHNlbGYubmF2Lm5leHQgPSAtMTtcbiAgICAgIHNlbGYubmV4dEJ1dHRvbi5oaWRlKCk7XG4gICAgfVxuICAgIGlmIChkYXRhLnF1ZXJpZXMgJiYgZGF0YS5xdWVyaWVzLnByZXZpb3VzUGFnZSkge1xuICAgICAgc2VsZi5uYXYucHJldiA9IGRhdGEucXVlcmllcy5wcmV2aW91c1BhZ2VbMF0uc3RhcnRJbmRleDtcbiAgICAgIHNlbGYucHJldkJ1dHRvbi5zaG93KCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgc2VsZi5uYXYucHJldiA9IC0xO1xuICAgICAgc2VsZi5wcmV2QnV0dG9uLmhpZGUoKTtcbiAgICB9XG4gIH07XG4gIFxuICBcbiAgLyoqXG4gICAqIFNlbmQgYSBHRVQgcmVxdWVzdCB0byBHb29nbGUgQ3VzdG9tIFNlYXJjaCBBUElcbiAgICogQHBhcmFtIHF1ZXJ5VGV4dCA6IChzdHJpbmcpIHRoZSBxdWVyeSB0ZXh0XG4gICAqL1xuICBzZWxmLnF1ZXJ5ID0gZnVuY3Rpb24ocXVlcnlUZXh0LCBzdGFydEluZGV4LCBjYWxsYmFjaykge1xuICAgIHNlbGYuZXJyb3JDb250YWluZXIuaGlkZSgpO1xuICAgIHNlbGYuYWpheENvbnRlbnQucmVtb3ZlQ2xhc3MoJ2xvYWRlZCcpO1xuICAgICQuZ2V0KEdPT0dMRV9DVVNUT01fU0VBUkNIX0VORFBPSU5ULCB7XG4gICAgICBrZXk6IGNvbmZpZy5hcGlLZXksXG4gICAgICBjeDogY29uZmlnLmVuZ2luZUlkLFxuICAgICAgcTogcXVlcnlUZXh0LFxuICAgICAgc3RhcnQ6IHN0YXJ0SW5kZXgsXG4gICAgICBudW06IFBFUl9QQUdFXG4gICAgfSwgZnVuY3Rpb24oZGF0YSwgc3RhdHVzKSB7XG4gICAgICBjb25zb2xlLmxvZyhzdGF0dXMpO1xuICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICBpZiAoc3RhdHVzID09PSAnc3VjY2VzcycgJiYgZGF0YS5pdGVtcyAmJiBkYXRhLml0ZW1zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgdmFyIHJlc3VsdHMgPSBzZWxmLmJ1aWxkUmVzdWx0cyhkYXRhLml0ZW1zKTsgXG4gICAgICAgIHNlbGYucmVzdWx0Q29udGFpbmVyLmh0bWwocmVzdWx0cyk7ICAgICAgIFxuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIHZhciBlcnJNc2cgPSBcIlwiO1xuICAgICAgICBpZiAoc3RhdHVzID09PSBcInN1Y2Nlc3NcIikgZXJyTXNnID0gXCJObyByZXN1bHQgZm91bmQgZm9yIFxcXCJcIiArcXVlcnlUZXh0KyBcIlxcXCIuXCI7XG4gICAgICAgIGVsc2UgaWYgKHN0YXR1cyA9PT0gXCJ0aW1lb3V0XCIpIGVyck1zZyA9IFwiVW5mb3J0dW5hdGUgdGltZW91dC5cIjtcbiAgICAgICAgZWxzZSBlcnJNc2cgPSBcIk15c3RlcmlvdXMgZmFpbHVyZS5cIjtcbiAgICAgICAgc2VsZi5yZXN1bHRDb250YWluZXIuaHRtbChcIlwiKTtcbiAgICAgICAgc2VsZi5lcnJvckNvbnRhaW5lci5odG1sKGVyck1zZyk7XG4gICAgICAgIHNlbGYuZXJyb3JDb250YWluZXIuc2hvdygpO1xuICAgICAgfVxuICAgICAgc2VsZi5idWlsZE1ldGFkYXRhKGRhdGEpO1xuICAgICAgc2VsZi5hamF4Q29udGVudC5hZGRDbGFzcygnbG9hZGVkJyk7XG4gICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgY2FsbGJhY2soZGF0YSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG4gIFxuICAvKipcbiAgICogU2VhcmNoZm9ybSBzdWJtaXQgZXZlbnQgaGFuZGxlclxuICAgKiBAcGFyYW0gcXVlcnlUZXh0IDogKHN0cmluZykgdGhlIHF1ZXJ5IHRleHRcbiAgICovXG4gIHNlbGYuc2VhcmNoID0gZnVuY3Rpb24ocXVlcnlUZXh0KSB7XG4gICAgLy8gVUkgdXBkYXRlXG4gICAgaWYgKCFzZWxmLm9wZW4pIHtcbiAgICAgIHNlbGYubW9kYWwuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgJCgnYm9keScpLmFkZENsYXNzKCdtb2RhbC1hY3RpdmUnKTtcbiAgICB9XG4gICAgc2VsZi5zZWFyY2hJbnB1dC5lYWNoKGZ1bmN0aW9uKGluZGV4LGVsZW0pIHtcbiAgICAgICQoZWxlbSkudmFsKHF1ZXJ5VGV4dCk7XG4gICAgfSk7XG4gICAgLy8gQWpheCBHRVRcbiAgICBzZWxmLnF1ZXJ5KHF1ZXJ5VGV4dCwgMSk7XG4gIH07XG4gIFxuICAvKipcbiAgICogQ2xvc2UgdGhlIG1vZGFsLCByZXN1bWUgYm9keSBzY3JvbGxpbmdcbiAgICogbm8gcGFyYW1cbiAgICovXG4gIHNlbGYuY2xvc2UgPSBmdW5jdGlvbigpIHtcbiAgICBzZWxmLm9wZW4gPSBmYWxzZTtcbiAgICBzZWxmLm1vZGFsLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAkKCdib2R5JykucmVtb3ZlQ2xhc3MoJ21vZGFsLWFjdGl2ZScpO1xuICB9O1xuICBcbiAgLyoqXG4gICAqIFJlZ2lzdGVyIGV2ZW50IGhhbmRsZXJzXG4gICAqIG5vIHBhcmFtXG4gICAqL1xuICBzZWxmLmluaXQgPSBmdW5jdGlvbigpIHtcbiAgICBzZWxmLnNlYXJjaEZvcm0uZWFjaChmdW5jdGlvbihpbmRleCxlbGVtKSB7XG4gICAgICAkKGVsZW0pLm9uKCdzdWJtaXQnLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBzZWxmLnF1ZXJ5VGV4dCA9ICQodGhpcykuY2hpbGRyZW4oJy5zZWFyY2hfaW5wdXQnKS52YWwoKTtcbiAgICAgICAgc2VsZi5zZWFyY2goc2VsZi5xdWVyeVRleHQpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgc2VsZi5vdmVybGF5Lm9uKCdjbGljaycsIHNlbGYuY2xvc2UpO1xuICAgIHNlbGYubmV4dEJ1dHRvbi5vbignY2xpY2snLCBzZWxmLm5leHRQYWdlKTtcbiAgICBzZWxmLnByZXZCdXR0b24ub24oJ2NsaWNrJywgc2VsZi5wcmV2UGFnZSk7XG4gICAgc2VsZi5jbG9zZUJ1dHRvbi5vbignY2xpY2snLCBzZWxmLmNsb3NlKTtcbiAgfTtcbiAgXG4gIHNlbGYuaW5pdCgpO1xufTsiLCIoZnVuY3Rpb24oJCkge1xuXHRcblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFxuXHR2YXIgR09PR0xFX0NVU1RPTV9TRUFSQ0hfRU5BQkxFID0gdHJ1ZTtcblx0dmFyIEdPT0dMRV9DVVNUT01fU0VBUkNIX0FQSV9LRVkgPSBcIkFJemFTeURHZDVKSkg3clIzc2dTLUpQWWJsd0o3MkdPc3F6aWdoY1wiO1xuXHR2YXIgR09PR0xFX0NVU1RPTV9TRUFSQ0hfRU5HSU5FX0lEID0gXCIwMTc4MjEwMjkzNzgxNjM0NTg1Mjc6bXNxa29jaGNzajBcIjtcblx0dmFyIGN1c3RvbVNlYXJjaCA9IHt9O1xuXHRcblx0dmFyIEVYQ0VSUFRfR0VORVJBVE9SX0VOQUJMRSA9IHRydWU7XG5cdHZhciBleGNlcnB0R2VuZXJhdG9yID0ge307XG4gIFxuICB2YXIgc2Nyb2xsdG9FbGVtZW50ID0gZnVuY3Rpb24oZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB2YXIgc2VsZiA9ICQodGhpcyksXG4gICAgICAgIGNvcnJlY3Rpb24gPSBlLmRhdGEgPyBlLmRhdGEuY29ycmVjdGlvbiA/IGUuZGF0YS5jb3JyZWN0aW9uIDogMCA6IDA7XG4gICAgJCgnaHRtbCwgYm9keScpLmFuaW1hdGUoeydzY3JvbGxUb3AnOiAkKHNlbGYuYXR0cignaHJlZicpKS5vZmZzZXQoKS50b3AgLSBjb3JyZWN0aW9uIH0sIDQwMCk7XG4gIH07XG5cdFxuICB2YXIgY2xvc2VNZW51ID0gZnVuY3Rpb24oZSkge1xuXHQgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgJCgnYm9keScpLnJlbW92ZUNsYXNzKCdtZW51LW9wZW4nKTtcblx0XHQkKCcuc2l0ZS1uYXYtc3dpdGNoJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICB9O1xuICBcbiAgdmFyIHRvZ2dsZU1lbnUgPSBmdW5jdGlvbihlKSB7XG5cdCAgZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0ICAkKCdib2R5JykudG9nZ2xlQ2xhc3MoJ21lbnUtb3BlbicpO1xuICAgICQoJy5zaXRlLW5hdi1zd2l0Y2gnKS50b2dnbGVDbGFzcygnYWN0aXZlJyk7XG4gIH07XG4gIFxuICB2YXIgcGl4aXZBcmNoaXZlU3RhdCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciB2b2wgPSAkKFwiLnNpbmdsZSAuY29udGVudCB1bFwiKS5sZW5ndGg7XG4gICAgdmFyIGFydGlzdENvdW50ID0gJChcIi5zaW5nbGUgLmNvbnRlbnQgdWwgbGlcIikubGVuZ3RoO1xuICAgICQoXCIjcGl4aXYtdm9sXCIpLnRleHQodm9sKTtcbiAgICAkKFwiI3BpeGl2LWFydGlzdC1jb3VudFwiKS50ZXh0KGFydGlzdENvdW50KTtcbiAgfTtcbiAgXG4gIHZhciBFeGNlcnB0R2VuZXJhdG9yID0gZnVuY3Rpb24oc2VsZWN0b3IpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgc2VsZi5pbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoIUVYQ0VSUFRfR0VORVJBVE9SX0VOQUJMRSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICAkKHNlbGVjdG9yKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgcG9zdCA9ICQodGhpcyk7XG4gICAgICAgIHZhciBwZXJtYWxpbmsgPSBwb3N0LmZpbmQoJ2gyLnRpdGxlID4gYScpLmF0dHIoJ2hyZWYnKTtcbiAgICAgICAgdmFyIGNvbnRlbnRUYWcgPSBwb3N0LmZpbmQoJ3NlY3Rpb24uY29udGVudCcpO1xuICAgICAgICB2YXIgY29udGVudExvYWRpbmdUYWcgPSBwb3N0LmZpbmQoJy5jb250ZW50LWxvYWRpbmcnKTtcbiAgICAgICAgdmFyIGNvbnRlbnQgPSBjb250ZW50VGFnLmh0bWwoKTtcbiAgICAgICAgdmFyIHJlID0gLzwhLS0gKm1vcmUgKi0tPigufFxcbikqL2k7XG4gICAgICAgIHZhciBleGNlcnB0ID0gY29udGVudC5yZXBsYWNlKHJlLFwiXCIpO1xuICAgICAgICBpZiAoY29udGVudC5sZW5ndGggIT09IGV4Y2VycHQubGVuZ3RoKSB7XG4gICAgICAgICAgZXhjZXJwdCArPSBcIjxhIGhyZWY9J1wiICtwZXJtYWxpbmsrIFwiJyBjbGFzcz0ncmVhZG1vcmUnPlJlYWQgTW9yZS4uLjwvYT5cIjtcbiAgICAgICAgfVxuICAgICAgICBjb250ZW50VGFnLmh0bWwoZXhjZXJwdCk7XG4gICAgICAgIGNvbnRlbnRUYWcuYWRkQ2xhc3MoJ2V4Y2VycHQtcmVhZHknKTtcbiAgICAgICAgY29udGVudExvYWRpbmdUYWcuYWRkQ2xhc3MoJ2V4Y2VycHQtcmVhZHknKTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgc2VsZi5pbml0KCk7XG4gIH07XG5cdFxuXHQkKGZ1bmN0aW9uKCkge1xuXHRcdCQoJyNmb290ZXIsICNtYWluJykuYWRkQ2xhc3MoJ2xvYWRlZCcpO1xuXHRcdCQoJy5zaXRlLW5hdi1zd2l0Y2gnKS5vbignY2xpY2snLCB0b2dnbGVNZW51KTtcblx0XHQkKGRvY3VtZW50KS5vbignY2xpY2snLCBjbG9zZU1lbnUpO1xuXHRcdCQoJy5zaXRlLW1lbnUnKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdH0pO1xuXHRcdCQoJy53aW5kb3ctbmF2LCAuZ28tY29tbWVudCcpLm9uKCdjbGljaycsIHNjcm9sbHRvRWxlbWVudCk7XG5cblx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHQgICAgJCgnI2xvYWRpbmctYmFyLXdyYXBwZXInKS5mYWRlT3V0KDUwMCk7XG5cdCAgfSwgMzAwKTtcblx0ICBcblx0ICBpZiAoJCgnYm9keScpLmhhc0NsYXNzKCd0YWctcGl4aXYnKSAmJiAkKFwiYm9keVwiKS5oYXNDbGFzcygncGFnZScpKSB7XG4gIFx0ICBwaXhpdkFyY2hpdmVTdGF0KCk7XG5cdCAgfVxuXHQgIFxuXHQgIGV4Y2VycHRHZW5lcmF0b3IgPSBuZXcgRXhjZXJwdEdlbmVyYXRvcignLnBvc3QtbGlzdCAucG9zdCcpO1xuXHQgIGN1c3RvbVNlYXJjaCA9IG5ldyBHb29nbGVDdXN0b21TZWFyY2goe1xuICBcdCAgYXBpS2V5OiBHT09HTEVfQ1VTVE9NX1NFQVJDSF9BUElfS0VZLFxuICBcdCAgZW5naW5lSWQ6IEdPT0dMRV9DVVNUT01fU0VBUkNIX0VOR0lORV9JRFxuXHQgIH0pO1xuXHR9KTtcblx0XHRcbn0pKGpRdWVyeSk7Il19
