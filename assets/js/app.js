var GoogleCustomSearch=function(e){var t=this,n="https://www.googleapis.com/customsearch/v1",a=10,o=$.extend({form:".searchform",input:".searchform .search_input",modal:"#modal-search",overlay:"#modal-search .overlay",resultContainer:"#modal-search .results",closeButton:"#modal-search .close",nextButton:"#modal-search .next",prevButton:"#modal-search .prev",metadata:"#modal-search .meta",ajaxContent:"#modal-search .ajax-content, #modal-search .loading",loadingBar:"#modal-search .loading .bar",errorContainer:"#modal-search .modal-footer .error"},e);t.config=o,t.searchForm=$(o.form),t.searchInput=$(o.input),t.modal=$(o.modal),t.overlay=$(o.overlay),t.resultContainer=$(o.resultContainer),t.closeButton=$(o.closeButton),t.prevButton=$(o.prevButton),t.nextButton=$(o.nextButton),t.metadata=$(o.metadata),t.ajaxContent=$(o.ajaxContent),t.errorContainer=$(o.errorContainer),t.loadingBar=$(o.loadingBar),t.open=!1,t.queryText="",t.nav={next:-1,prev:-1,total:0,current:1},t.nextPage=function(){-1!==t.nav.next&&(o.onBeforeNextPage instanceof Function&&o.onBeforeNextPage.call(t),t.query(t.queryText,t.nav.next,function(e){o.onAfterNextPage instanceof Function&&o.onAfterNextPage.call(t,e)}))},t.prevPage=function(){-1!==t.nav.prev&&(o.onBeforePrevPage instanceof Function&&o.onBeforePrevPage.call(t),t.query(t.queryText,t.nav.prev,function(e){o.onAfterPrevPage instanceof Function&&o.onAfterPrevPage.call(t,e)}))},t.buildResults=function(e){var t="";return $.each(e,function(e,n){t+="<li>",t+="<a class='result' href='"+n.link+"'>",t+="<span class='title'>"+n.title+"</span>",t+="<span class='digest'>"+n.htmlSnippet.replace("<br>","")+"</span>",t+="<span class='icon icon-chevron-thin-right'></span>",t+="</a>",t+="</li>"}),t},t.buildMetadata=function(e){e.queries&&e.queries.request&&"0"!==e.queries.request[0].totalResults?(t.nav.current=e.queries.request[0].startIndex,t.nav.currentCount=e.queries.request[0].count,t.nav.total=parseInt(e.queries.request[0].totalResults),t.metadata.children(".total").html(t.nav.total),t.metadata.children(".range").html(t.nav.current+"-"+(t.nav.current+t.nav.currentCount-1)),t.metadata.show()):t.metadata.hide(),e.queries&&e.queries.nextPage?(t.nav.next=e.queries.nextPage[0].startIndex,t.nextButton.show()):(t.nav.next=-1,t.nextButton.hide()),e.queries&&e.queries.previousPage?(t.nav.prev=e.queries.previousPage[0].startIndex,t.prevButton.show()):(t.nav.prev=-1,t.prevButton.hide())},t.query=function(e,r,s){t.errorContainer.hide(),t.ajaxContent.removeClass("loaded"),$.get(n,{key:o.apiKey,cx:o.engineId,q:e,start:r,num:a},function(n,a){if(console.log(a),console.log(n),"success"===a&&n.items&&n.items.length>0){var o=t.buildResults(n.items);t.resultContainer.html(o)}else{var r="";r="success"===a?'No result found for "'+e+'".':"timeout"===a?"Unfortunate timeout.":"Mysterious failure.",t.resultContainer.html(""),t.errorContainer.html(r),t.errorContainer.show()}t.buildMetadata(n),t.ajaxContent.addClass("loaded"),s&&s(n)})},t.search=function(e){t.open||(t.modal.addClass("active"),$("body").addClass("modal-active")),t.searchInput.each(function(t,n){$(n).val(e)}),document.activeElement.blur(),t.query(e,1)},t.close=function(){t.open=!1,t.modal.removeClass("active"),$("body").removeClass("modal-active")},t.init=function(){t.searchForm.each(function(e,n){$(n).on("submit",function(e){e.preventDefault(),t.queryText=$(this).children(".search_input").val(),t.search(t.queryText)})}),t.overlay.on("click",t.close),t.nextButton.on("click",t.nextPage),t.prevButton.on("click",t.prevPage),t.closeButton.on("click",t.close)},t.init()};!function(e){"use strict";var t=!0,n=!0,a="AIzaSyDGd5JJH7rR3sgS-JPYblwJ72GOsqzighc",o="017821029378163458527:msqkochcsj0",r={},s={},i=function(t){t.preventDefault();var n=e(this),a=t.data&&t.data.correction?t.data.correction:0;e("html, body").animate({scrollTop:e(n.attr("href")).offset().top-a},400)},c=function(t){t.stopPropagation(),e("body").removeClass("menu-open"),e(".site-nav-switch").removeClass("active")},l=function(t){t.stopPropagation(),e("body").toggleClass("menu-open"),e(".site-nav-switch").toggleClass("active")},u=function(){var t=e(".single .content ul").length,n=e(".single .content ul li").length;e("#pixiv-vol").text(t),e("#pixiv-artist-count").text(n)},d=function(t){var n=this;n.init=function(){e(t).each(function(){var t=e(this),n=t.find("h2.title > a").attr("href"),a=t.find("section.content"),o=t.find(".content-loading"),r=a.html(),s=/<!-- *more *-->(.|\n)*/i,i=r.replace(s,"");r.length!==i.length&&(i+="<a href='"+n+"' class='readmore'>Read More...</a>"),a.html(i),a.addClass("excerpt-ready"),o.addClass("excerpt-ready")})},n.init()};e(function(){e("#footer, #main").addClass("loaded"),e(".site-nav-switch").on("click",l),e(document).on("click",c),e(".site-menu").on("click",function(e){e.stopPropagation()}),e(".window-nav, .go-comment").on("click",i),setTimeout(function(){e("#loading-bar-wrapper").fadeOut(500)},300),e("body").hasClass("tag-pixiv")&&e("body").hasClass("page")&&u(),n&&(s=new d(".post-list .post")),t&&(r=new GoogleCustomSearch({apiKey:a,engineId:o}))})}(jQuery);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdvb2dsZS1jdXN0b20tc2VhcmNoLmpzIiwiYXBwLmpzIl0sIm5hbWVzIjpbIkdvb2dsZUN1c3RvbVNlYXJjaCIsIm9wdGlvbnMiLCJzZWxmIiwidGhpcyIsIkdPT0dMRV9DVVNUT01fU0VBUkNIX0VORFBPSU5UIiwiUEVSX1BBR0UiLCJjb25maWciLCIkIiwiZXh0ZW5kIiwiZm9ybSIsImlucHV0IiwibW9kYWwiLCJvdmVybGF5IiwicmVzdWx0Q29udGFpbmVyIiwiY2xvc2VCdXR0b24iLCJuZXh0QnV0dG9uIiwicHJldkJ1dHRvbiIsIm1ldGFkYXRhIiwiYWpheENvbnRlbnQiLCJsb2FkaW5nQmFyIiwiZXJyb3JDb250YWluZXIiLCJzZWFyY2hGb3JtIiwic2VhcmNoSW5wdXQiLCJvcGVuIiwicXVlcnlUZXh0IiwibmF2IiwibmV4dCIsInByZXYiLCJ0b3RhbCIsImN1cnJlbnQiLCJuZXh0UGFnZSIsIm9uQmVmb3JlTmV4dFBhZ2UiLCJGdW5jdGlvbiIsImNhbGwiLCJxdWVyeSIsImRhdGEiLCJvbkFmdGVyTmV4dFBhZ2UiLCJwcmV2UGFnZSIsIm9uQmVmb3JlUHJldlBhZ2UiLCJvbkFmdGVyUHJldlBhZ2UiLCJidWlsZFJlc3VsdHMiLCJodG1sIiwiZWFjaCIsImluZGV4Iiwicm93IiwibGluayIsInRpdGxlIiwiaHRtbFNuaXBwZXQiLCJyZXBsYWNlIiwiYnVpbGRNZXRhZGF0YSIsInF1ZXJpZXMiLCJyZXF1ZXN0IiwidG90YWxSZXN1bHRzIiwic3RhcnRJbmRleCIsImN1cnJlbnRDb3VudCIsImNvdW50IiwicGFyc2VJbnQiLCJjaGlsZHJlbiIsInNob3ciLCJoaWRlIiwicHJldmlvdXNQYWdlIiwiY2FsbGJhY2siLCJyZW1vdmVDbGFzcyIsImdldCIsImtleSIsImFwaUtleSIsImN4IiwiZW5naW5lSWQiLCJxIiwic3RhcnQiLCJudW0iLCJzdGF0dXMiLCJjb25zb2xlIiwibG9nIiwiaXRlbXMiLCJsZW5ndGgiLCJyZXN1bHRzIiwiZXJyTXNnIiwiYWRkQ2xhc3MiLCJzZWFyY2giLCJlbGVtIiwidmFsIiwiZG9jdW1lbnQiLCJhY3RpdmVFbGVtZW50IiwiYmx1ciIsImNsb3NlIiwiaW5pdCIsIm9uIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsIkdPT0dMRV9DVVNUT01fU0VBUkNIX0VOQUJMRSIsIkVYQ0VSUFRfR0VORVJBVE9SX0VOQUJMRSIsIkdPT0dMRV9DVVNUT01fU0VBUkNIX0FQSV9LRVkiLCJHT09HTEVfQ1VTVE9NX1NFQVJDSF9FTkdJTkVfSUQiLCJjdXN0b21TZWFyY2giLCJleGNlcnB0R2VuZXJhdG9yIiwic2Nyb2xsdG9FbGVtZW50IiwiZSIsImNvcnJlY3Rpb24iLCJhbmltYXRlIiwic2Nyb2xsVG9wIiwiYXR0ciIsIm9mZnNldCIsInRvcCIsImNsb3NlTWVudSIsInN0b3BQcm9wYWdhdGlvbiIsInRvZ2dsZU1lbnUiLCJ0b2dnbGVDbGFzcyIsInBpeGl2QXJjaGl2ZVN0YXQiLCJ2b2wiLCJhcnRpc3RDb3VudCIsInRleHQiLCJFeGNlcnB0R2VuZXJhdG9yIiwic2VsZWN0b3IiLCJwb3N0IiwicGVybWFsaW5rIiwiZmluZCIsImNvbnRlbnRUYWciLCJjb250ZW50TG9hZGluZ1RhZyIsImNvbnRlbnQiLCJyZSIsImV4Y2VycHQiLCJzZXRUaW1lb3V0IiwiZmFkZU91dCIsImhhc0NsYXNzIiwialF1ZXJ5Il0sIm1hcHBpbmdzIjoiQUFBQSxHQUFBQSxvQkFBQSxTQUFBQyxHQUNBLEdBQUFDLEdBQUFDLEtBQ0FDLEVBQUEsNkNBQ0FDLEVBQUEsR0FFQUMsRUFBQUMsRUFBQUMsUUFDQUMsS0FBQSxjQUNBQyxNQUFBLDRCQUNBQyxNQUFBLGdCQUNBQyxRQUFBLHlCQUNBQyxnQkFBQSx5QkFDQUMsWUFBQSx1QkFDQUMsV0FBQSxzQkFDQUMsV0FBQSxzQkFDQUMsU0FBQSxzQkFDQUMsWUFBQSxzREFDQUMsV0FBQSw4QkFDQUMsZUFBQSxzQ0FDQW5CLEVBRUFDLEdBQUFJLE9BQUFBLEVBRUFKLEVBQUFtQixXQUFBZCxFQUFBRCxFQUFBRyxN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S0FBQUQsSUFHQUUsRUFBQSxTQUFBQyxHQUNBLEdBQUEvRyxHQUFBQyxJQUNBRCxHQUFBb0YsS0FBQSxXQUNBL0UsRUFBQTBHLEdBQUF2RSxLQUFBLFdBQ0EsR0FBQXdFLEdBQUEzRyxFQUFBSixNQUNBZ0gsRUFBQUQsRUFBQUUsS0FBQSxnQkFBQWYsS0FBQSxRQUNBZ0IsRUFBQUgsRUFBQUUsS0FBQSxtQkFDQUUsRUFBQUosRUFBQUUsS0FBQSxvQkFDQUcsRUFBQUYsRUFBQTVFLE9BQ0ErRSxFQUFBLDBCQUNBQyxFQUFBRixFQUFBdkUsUUFBQXdFLEVBQUEsR0FDQUQsR0FBQTVDLFNBQUE4QyxFQUFBOUMsU0FDQThDLEdBQUEsWUFBQU4sRUFBQSx1Q0FFQUUsRUFBQTVFLEtBQUFnRixHQUNBSixFQUFBdkMsU0FBQSxpQkFDQXdDLEVBQUF4QyxTQUFBLG9CQUdBNUUsRUFBQW9GLE9BR0EvRSxHQUFBLFdBQ0FBLEVBQUEsa0JBQUF1RSxTQUFBLFVBQ0F2RSxFQUFBLG9CQUFBZ0YsR0FBQSxRQUFBbUIsR0FDQW5HLEVBQUEyRSxVQUFBSyxHQUFBLFFBQUFpQixHQUNBakcsRUFBQSxjQUFBZ0YsR0FBQSxRQUFBLFNBQUFVLEdBQ0FBLEVBQUFRLG9CQUVBbEcsRUFBQSw0QkFBQWdGLEdBQUEsUUFBQVMsR0FFQTBCLFdBQUEsV0FDQW5ILEVBQUEsd0JBQUFvSCxRQUFBLE1BQ0EsS0FFQXBILEVBQUEsUUFBQXFILFNBQUEsY0FBQXJILEVBQUEsUUFBQXFILFNBQUEsU0FDQWhCLElBRUFqQixJQUNBSSxFQUFBLEdBQUFpQixHQUFBLHFCQUVBdEIsSUFDQUksRUFBQSxHQUFBOUYscUJBQ0FpRSxPQUFBMkIsRUFDQXpCLFNBQUEwQixRQUtBZ0MiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIEdvb2dsZUN1c3RvbVNlYXJjaCA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICB2YXIgR09PR0xFX0NVU1RPTV9TRUFSQ0hfRU5EUE9JTlQgPSBcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2N1c3RvbXNlYXJjaC92MVwiO1xuICB2YXIgUEVSX1BBR0UgPSAxMDsgLy8gbXVzdCBiZSBiZXR3ZWVuIDEtMTBcbiAgXG4gIHZhciBjb25maWcgPSAkLmV4dGVuZCh7XG4gICAgZm9ybTogXCIuc2VhcmNoZm9ybVwiLFxuICAgIGlucHV0OiBcIi5zZWFyY2hmb3JtIC5zZWFyY2hfaW5wdXRcIixcbiAgICBtb2RhbDogXCIjbW9kYWwtc2VhcmNoXCIsXG4gICAgb3ZlcmxheTogXCIjbW9kYWwtc2VhcmNoIC5vdmVybGF5XCIsXG4gICAgcmVzdWx0Q29udGFpbmVyOiBcIiNtb2RhbC1zZWFyY2ggLnJlc3VsdHNcIixcbiAgICBjbG9zZUJ1dHRvbjogXCIjbW9kYWwtc2VhcmNoIC5jbG9zZVwiLFxuICAgIG5leHRCdXR0b246IFwiI21vZGFsLXNlYXJjaCAubmV4dFwiLFxuICAgIHByZXZCdXR0b246IFwiI21vZGFsLXNlYXJjaCAucHJldlwiLFxuICAgIG1ldGFkYXRhOiBcIiNtb2RhbC1zZWFyY2ggLm1ldGFcIixcbiAgICBhamF4Q29udGVudDogXCIjbW9kYWwtc2VhcmNoIC5hamF4LWNvbnRlbnQsICNtb2RhbC1zZWFyY2ggLmxvYWRpbmdcIixcbiAgICBsb2FkaW5nQmFyOiBcIiNtb2RhbC1zZWFyY2ggLmxvYWRpbmcgLmJhclwiLFxuICAgIGVycm9yQ29udGFpbmVyOiBcIiNtb2RhbC1zZWFyY2ggLm1vZGFsLWZvb3RlciAuZXJyb3JcIlxuICB9LCBvcHRpb25zKTtcbiAgXG4gIHNlbGYuY29uZmlnID0gY29uZmlnO1xuICBcbiAgc2VsZi5zZWFyY2hGb3JtID0gJChjb25maWcuZm9ybSk7XG4gIHNlbGYuc2VhcmNoSW5wdXQgPSAkKGNvbmZpZy5pbnB1dCk7XG4gIHNlbGYubW9kYWwgPSAkKGNvbmZpZy5tb2RhbCk7XG4gIHNlbGYub3ZlcmxheSA9ICQoY29uZmlnLm92ZXJsYXkpO1xuICBzZWxmLnJlc3VsdENvbnRhaW5lciA9ICQoY29uZmlnLnJlc3VsdENvbnRhaW5lcik7XG4gIHNlbGYuY2xvc2VCdXR0b24gPSAkKGNvbmZpZy5jbG9zZUJ1dHRvbik7XG4gIHNlbGYucHJldkJ1dHRvbiA9ICQoY29uZmlnLnByZXZCdXR0b24pO1xuICBzZWxmLm5leHRCdXR0b24gPSAkKGNvbmZpZy5uZXh0QnV0dG9uKTtcbiAgc2VsZi5tZXRhZGF0YSA9ICQoY29uZmlnLm1ldGFkYXRhKTtcbiAgc2VsZi5hamF4Q29udGVudCA9ICQoY29uZmlnLmFqYXhDb250ZW50KTtcbiAgc2VsZi5lcnJvckNvbnRhaW5lciA9ICQoY29uZmlnLmVycm9yQ29udGFpbmVyKTtcbiAgc2VsZi5sb2FkaW5nQmFyID0gJChjb25maWcubG9hZGluZ0Jhcik7XG4gIFxuICBzZWxmLm9wZW4gPSBmYWxzZTtcbiAgc2VsZi5xdWVyeVRleHQgPSBcIlwiO1xuICBzZWxmLm5hdiA9IHtcbiAgICBuZXh0OiAtMSxcbiAgICBwcmV2OiAtMSxcbiAgICB0b3RhbDogMCxcbiAgICBjdXJyZW50OiAxXG4gIH07XG4gIFxuICAvKipcbiAgICogRmV0Y2ggbmV4dCBwYWdlIG9mIHJlc3VsdHMgKGlmIGV4aXN0cylcbiAgICogbm8gcGFyYW1cbiAgICovXG4gIHNlbGYubmV4dFBhZ2UgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAoc2VsZi5uYXYubmV4dCAhPT0gLTEpIHtcbiAgICAgIGlmIChjb25maWcub25CZWZvcmVOZXh0UGFnZSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XG4gICAgICAgIGNvbmZpZy5vbkJlZm9yZU5leHRQYWdlLmNhbGwoc2VsZik7XG4gICAgICB9XG4gICAgICBzZWxmLnF1ZXJ5KHNlbGYucXVlcnlUZXh0LCBzZWxmLm5hdi5uZXh0LCBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIGlmIChjb25maWcub25BZnRlck5leHRQYWdlIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcbiAgICAgICAgICBjb25maWcub25BZnRlck5leHRQYWdlLmNhbGwoc2VsZiwgZGF0YSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbiAgXG4gIC8qKlxuICAgKiBGZXRjaCBwcmV2aW91cyBwYWdlIG9mIHJlc3VsdHMgKGlmIGV4aXN0cylcbiAgICogbm8gcGFyYW1cbiAgICovXG4gIHNlbGYucHJldlBhZ2UgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAoc2VsZi5uYXYucHJldiAhPT0gLTEpIHtcbiAgICAgIGlmIChjb25maWcub25CZWZvcmVQcmV2UGFnZSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XG4gICAgICAgIGNvbmZpZy5vbkJlZm9yZVByZXZQYWdlLmNhbGwoc2VsZik7XG4gICAgICB9XG4gICAgICBzZWxmLnF1ZXJ5KHNlbGYucXVlcnlUZXh0LCBzZWxmLm5hdi5wcmV2LCBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIGlmIChjb25maWcub25BZnRlclByZXZQYWdlIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcbiAgICAgICAgICBjb25maWcub25BZnRlclByZXZQYWdlLmNhbGwoc2VsZiwgZGF0YSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbiAgXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSByZXN1bHQgbGlzdCBodG1sXG4gICAqIEBwYXJhbSBkYXRhIDogKGFycmF5KSByZXN1bHQgaXRlbXNcbiAgICovXG4gIHNlbGYuYnVpbGRSZXN1bHRzID0gZnVuY3Rpb24oZGF0YSkge1xuICAgIHZhciBodG1sID0gXCJcIjtcbiAgICAkLmVhY2goZGF0YSwgZnVuY3Rpb24oaW5kZXgsIHJvdykge1xuICAgICAgaHRtbCArPSBcIjxsaT5cIjtcbiAgICAgIGh0bWwgKz0gICBcIjxhIGNsYXNzPSdyZXN1bHQnIGhyZWY9J1wiICtyb3cubGluaysgXCInPlwiO1xuICAgICAgaHRtbCArPSAgICAgXCI8c3BhbiBjbGFzcz0ndGl0bGUnPlwiICtyb3cudGl0bGUrIFwiPC9zcGFuPlwiO1xuICAgICAgaHRtbCArPSAgICAgXCI8c3BhbiBjbGFzcz0nZGlnZXN0Jz5cIiArcm93Lmh0bWxTbmlwcGV0LnJlcGxhY2UoJzxicj4nLCcnKSsgXCI8L3NwYW4+XCI7XG4gICAgICBodG1sICs9ICAgICBcIjxzcGFuIGNsYXNzPSdpY29uIGljb24tY2hldnJvbi10aGluLXJpZ2h0Jz48L3NwYW4+XCI7XG4gICAgICBodG1sICs9ICAgXCI8L2E+XCI7XG4gICAgICBodG1sICs9IFwiPC9saT5cIjtcbiAgICB9KTtcbiAgICByZXR1cm4gaHRtbDtcbiAgfTtcbiAgXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBtZXRhZGF0YSBhZnRlciBhIHN1Y2Nlc3NmdWwgcXVlcnlcbiAgICogQHBhcmFtIGRhdGEgOiAob2JqZWN0KSB0aGUgcmF3IGdvb2dsZSBjdXN0b20gc2VhcmNoIHJlc3BvbnNlIGRhdGFcbiAgICovXG4gIHNlbGYuYnVpbGRNZXRhZGF0YSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICBpZiAoZGF0YS5xdWVyaWVzICYmIGRhdGEucXVlcmllcy5yZXF1ZXN0ICYmIGRhdGEucXVlcmllcy5yZXF1ZXN0WzBdLnRvdGFsUmVzdWx0cyAhPT0gJzAnKSB7XG4gICAgICBzZWxmLm5hdi5jdXJyZW50ID0gZGF0YS5xdWVyaWVzLnJlcXVlc3RbMF0uc3RhcnRJbmRleDtcbiAgICAgIHNlbGYubmF2LmN1cnJlbnRDb3VudCA9IGRhdGEucXVlcmllcy5yZXF1ZXN0WzBdLmNvdW50O1xuICAgICAgc2VsZi5uYXYudG90YWwgPSBwYXJzZUludChkYXRhLnF1ZXJpZXMucmVxdWVzdFswXS50b3RhbFJlc3VsdHMpO1xuICAgICAgc2VsZi5tZXRhZGF0YS5jaGlsZHJlbignLnRvdGFsJykuaHRtbChzZWxmLm5hdi50b3RhbCk7XG4gICAgICBzZWxmLm1ldGFkYXRhLmNoaWxkcmVuKCcucmFuZ2UnKS5odG1sKHNlbGYubmF2LmN1cnJlbnQgKyBcIi1cIiArIChzZWxmLm5hdi5jdXJyZW50K3NlbGYubmF2LmN1cnJlbnRDb3VudC0xKSk7XG4gICAgICBzZWxmLm1ldGFkYXRhLnNob3coKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBzZWxmLm1ldGFkYXRhLmhpZGUoKTtcbiAgICB9XG4gICAgaWYgKGRhdGEucXVlcmllcyAmJiBkYXRhLnF1ZXJpZXMubmV4dFBhZ2UpIHtcbiAgICAgIHNlbGYubmF2Lm5leHQgPSBkYXRhLnF1ZXJpZXMubmV4dFBhZ2VbMF0uc3RhcnRJbmRleDtcbiAgICAgIHNlbGYubmV4dEJ1dHRvbi5zaG93KCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgc2VsZi5uYXYubmV4dCA9IC0xO1xuICAgICAgc2VsZi5uZXh0QnV0dG9uLmhpZGUoKTtcbiAgICB9XG4gICAgaWYgKGRhdGEucXVlcmllcyAmJiBkYXRhLnF1ZXJpZXMucHJldmlvdXNQYWdlKSB7XG4gICAgICBzZWxmLm5hdi5wcmV2ID0gZGF0YS5xdWVyaWVzLnByZXZpb3VzUGFnZVswXS5zdGFydEluZGV4O1xuICAgICAgc2VsZi5wcmV2QnV0dG9uLnNob3coKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBzZWxmLm5hdi5wcmV2ID0gLTE7XG4gICAgICBzZWxmLnByZXZCdXR0b24uaGlkZSgpO1xuICAgIH1cbiAgfTtcbiAgXG4gIFxuICAvKipcbiAgICogU2VuZCBhIEdFVCByZXF1ZXN0IHRvIEdvb2dsZSBDdXN0b20gU2VhcmNoIEFQSVxuICAgKiBAcGFyYW0gcXVlcnlUZXh0IDogKHN0cmluZykgdGhlIHF1ZXJ5IHRleHRcbiAgICovXG4gIHNlbGYucXVlcnkgPSBmdW5jdGlvbihxdWVyeVRleHQsIHN0YXJ0SW5kZXgsIGNhbGxiYWNrKSB7XG4gICAgc2VsZi5lcnJvckNvbnRhaW5lci5oaWRlKCk7XG4gICAgc2VsZi5hamF4Q29udGVudC5yZW1vdmVDbGFzcygnbG9hZGVkJyk7XG4gICAgJC5nZXQoR09PR0xFX0NVU1RPTV9TRUFSQ0hfRU5EUE9JTlQsIHtcbiAgICAgIGtleTogY29uZmlnLmFwaUtleSxcbiAgICAgIGN4OiBjb25maWcuZW5naW5lSWQsXG4gICAgICBxOiBxdWVyeVRleHQsXG4gICAgICBzdGFydDogc3RhcnRJbmRleCxcbiAgICAgIG51bTogUEVSX1BBR0VcbiAgICB9LCBmdW5jdGlvbihkYXRhLCBzdGF0dXMpIHtcbiAgICAgIGNvbnNvbGUubG9nKHN0YXR1cyk7XG4gICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgIGlmIChzdGF0dXMgPT09ICdzdWNjZXNzJyAmJiBkYXRhLml0ZW1zICYmIGRhdGEuaXRlbXMubGVuZ3RoID4gMCkge1xuICAgICAgICB2YXIgcmVzdWx0cyA9IHNlbGYuYnVpbGRSZXN1bHRzKGRhdGEuaXRlbXMpOyBcbiAgICAgICAgc2VsZi5yZXN1bHRDb250YWluZXIuaHRtbChyZXN1bHRzKTsgICAgICAgXG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgdmFyIGVyck1zZyA9IFwiXCI7XG4gICAgICAgIGlmIChzdGF0dXMgPT09IFwic3VjY2Vzc1wiKSBlcnJNc2cgPSBcIk5vIHJlc3VsdCBmb3VuZCBmb3IgXFxcIlwiICtxdWVyeVRleHQrIFwiXFxcIi5cIjtcbiAgICAgICAgZWxzZSBpZiAoc3RhdHVzID09PSBcInRpbWVvdXRcIikgZXJyTXNnID0gXCJVbmZvcnR1bmF0ZSB0aW1lb3V0LlwiO1xuICAgICAgICBlbHNlIGVyck1zZyA9IFwiTXlzdGVyaW91cyBmYWlsdXJlLlwiO1xuICAgICAgICBzZWxmLnJlc3VsdENvbnRhaW5lci5odG1sKFwiXCIpO1xuICAgICAgICBzZWxmLmVycm9yQ29udGFpbmVyLmh0bWwoZXJyTXNnKTtcbiAgICAgICAgc2VsZi5lcnJvckNvbnRhaW5lci5zaG93KCk7XG4gICAgICB9XG4gICAgICBzZWxmLmJ1aWxkTWV0YWRhdGEoZGF0YSk7XG4gICAgICBzZWxmLmFqYXhDb250ZW50LmFkZENsYXNzKCdsb2FkZWQnKTtcbiAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICBjYWxsYmFjayhkYXRhKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcbiAgXG4gIC8qKlxuICAgKiBTZWFyY2hmb3JtIHN1Ym1pdCBldmVudCBoYW5kbGVyXG4gICAqIEBwYXJhbSBxdWVyeVRleHQgOiAoc3RyaW5nKSB0aGUgcXVlcnkgdGV4dFxuICAgKi9cbiAgc2VsZi5zZWFyY2ggPSBmdW5jdGlvbihxdWVyeVRleHQpIHtcbiAgICAvLyBVSSB1cGRhdGVcbiAgICBpZiAoIXNlbGYub3Blbikge1xuICAgICAgc2VsZi5tb2RhbC5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAkKCdib2R5JykuYWRkQ2xhc3MoJ21vZGFsLWFjdGl2ZScpO1xuICAgIH1cbiAgICBzZWxmLnNlYXJjaElucHV0LmVhY2goZnVuY3Rpb24oaW5kZXgsZWxlbSkge1xuICAgICAgJChlbGVtKS52YWwocXVlcnlUZXh0KTtcbiAgICB9KTtcbiAgICBkb2N1bWVudC5hY3RpdmVFbGVtZW50LmJsdXIoKTtcbiAgICAvLyBBamF4IEdFVFxuICAgIHNlbGYucXVlcnkocXVlcnlUZXh0LCAxKTtcbiAgfTtcbiAgXG4gIC8qKlxuICAgKiBDbG9zZSB0aGUgbW9kYWwsIHJlc3VtZSBib2R5IHNjcm9sbGluZ1xuICAgKiBubyBwYXJhbVxuICAgKi9cbiAgc2VsZi5jbG9zZSA9IGZ1bmN0aW9uKCkge1xuICAgIHNlbGYub3BlbiA9IGZhbHNlO1xuICAgIHNlbGYubW9kYWwucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICQoJ2JvZHknKS5yZW1vdmVDbGFzcygnbW9kYWwtYWN0aXZlJyk7XG4gIH07XG4gIFxuICAvKipcbiAgICogUmVnaXN0ZXIgZXZlbnQgaGFuZGxlcnNcbiAgICogbm8gcGFyYW1cbiAgICovXG4gIHNlbGYuaW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgIHNlbGYuc2VhcmNoRm9ybS5lYWNoKGZ1bmN0aW9uKGluZGV4LGVsZW0pIHtcbiAgICAgICQoZWxlbSkub24oJ3N1Ym1pdCcsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHNlbGYucXVlcnlUZXh0ID0gJCh0aGlzKS5jaGlsZHJlbignLnNlYXJjaF9pbnB1dCcpLnZhbCgpO1xuICAgICAgICBzZWxmLnNlYXJjaChzZWxmLnF1ZXJ5VGV4dCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgICBzZWxmLm92ZXJsYXkub24oJ2NsaWNrJywgc2VsZi5jbG9zZSk7XG4gICAgc2VsZi5uZXh0QnV0dG9uLm9uKCdjbGljaycsIHNlbGYubmV4dFBhZ2UpO1xuICAgIHNlbGYucHJldkJ1dHRvbi5vbignY2xpY2snLCBzZWxmLnByZXZQYWdlKTtcbiAgICBzZWxmLmNsb3NlQnV0dG9uLm9uKCdjbGljaycsIHNlbGYuY2xvc2UpO1xuICB9O1xuICBcbiAgc2VsZi5pbml0KCk7XG59OyIsIihmdW5jdGlvbigkKSB7XG5cdFxuXHRcInVzZSBzdHJpY3RcIjtcblx0XG5cdC8vIG9wdGlvbnNcblx0dmFyIEdPT0dMRV9DVVNUT01fU0VBUkNIX0VOQUJMRSA9IHRydWU7XG5cdHZhciBFWENFUlBUX0dFTkVSQVRPUl9FTkFCTEUgPSB0cnVlO1xuXHR2YXIgR09PR0xFX0NVU1RPTV9TRUFSQ0hfQVBJX0tFWSA9IFwiQUl6YVN5REdkNUpKSDdyUjNzZ1MtSlBZYmx3SjcyR09zcXppZ2hjXCI7XG5cdHZhciBHT09HTEVfQ1VTVE9NX1NFQVJDSF9FTkdJTkVfSUQgPSBcIjAxNzgyMTAyOTM3ODE2MzQ1ODUyNzptc3Frb2NoY3NqMFwiO1xuXG5cblx0dmFyIGN1c3RvbVNlYXJjaCA9IHt9O1xuXHR2YXIgZXhjZXJwdEdlbmVyYXRvciA9IHt9O1xuICBcbiAgdmFyIHNjcm9sbHRvRWxlbWVudCA9IGZ1bmN0aW9uKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgdmFyIHNlbGYgPSAkKHRoaXMpLFxuICAgICAgICBjb3JyZWN0aW9uID0gZS5kYXRhID8gZS5kYXRhLmNvcnJlY3Rpb24gPyBlLmRhdGEuY29ycmVjdGlvbiA6IDAgOiAwO1xuICAgICQoJ2h0bWwsIGJvZHknKS5hbmltYXRlKHsnc2Nyb2xsVG9wJzogJChzZWxmLmF0dHIoJ2hyZWYnKSkub2Zmc2V0KCkudG9wIC0gY29ycmVjdGlvbiB9LCA0MDApO1xuICB9O1xuXHRcbiAgdmFyIGNsb3NlTWVudSA9IGZ1bmN0aW9uKGUpIHtcblx0ICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICQoJ2JvZHknKS5yZW1vdmVDbGFzcygnbWVudS1vcGVuJyk7XG5cdFx0JCgnLnNpdGUtbmF2LXN3aXRjaCcpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgfTtcbiAgXG4gIHZhciB0b2dnbGVNZW51ID0gZnVuY3Rpb24oZSkge1xuXHQgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdCAgJCgnYm9keScpLnRvZ2dsZUNsYXNzKCdtZW51LW9wZW4nKTtcbiAgICAkKCcuc2l0ZS1uYXYtc3dpdGNoJykudG9nZ2xlQ2xhc3MoJ2FjdGl2ZScpO1xuICB9O1xuICBcbiAgdmFyIHBpeGl2QXJjaGl2ZVN0YXQgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgdm9sID0gJChcIi5zaW5nbGUgLmNvbnRlbnQgdWxcIikubGVuZ3RoO1xuICAgIHZhciBhcnRpc3RDb3VudCA9ICQoXCIuc2luZ2xlIC5jb250ZW50IHVsIGxpXCIpLmxlbmd0aDtcbiAgICAkKFwiI3BpeGl2LXZvbFwiKS50ZXh0KHZvbCk7XG4gICAgJChcIiNwaXhpdi1hcnRpc3QtY291bnRcIikudGV4dChhcnRpc3RDb3VudCk7XG4gIH07XG4gIFxuICB2YXIgRXhjZXJwdEdlbmVyYXRvciA9IGZ1bmN0aW9uKHNlbGVjdG9yKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNlbGYuaW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgJChzZWxlY3RvcikuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHBvc3QgPSAkKHRoaXMpO1xuICAgICAgICB2YXIgcGVybWFsaW5rID0gcG9zdC5maW5kKCdoMi50aXRsZSA+IGEnKS5hdHRyKCdocmVmJyk7XG4gICAgICAgIHZhciBjb250ZW50VGFnID0gcG9zdC5maW5kKCdzZWN0aW9uLmNvbnRlbnQnKTtcbiAgICAgICAgdmFyIGNvbnRlbnRMb2FkaW5nVGFnID0gcG9zdC5maW5kKCcuY29udGVudC1sb2FkaW5nJyk7XG4gICAgICAgIHZhciBjb250ZW50ID0gY29udGVudFRhZy5odG1sKCk7XG4gICAgICAgIHZhciByZSA9IC88IS0tICptb3JlICotLT4oLnxcXG4pKi9pO1xuICAgICAgICB2YXIgZXhjZXJwdCA9IGNvbnRlbnQucmVwbGFjZShyZSxcIlwiKTtcbiAgICAgICAgaWYgKGNvbnRlbnQubGVuZ3RoICE9PSBleGNlcnB0Lmxlbmd0aCkge1xuICAgICAgICAgIGV4Y2VycHQgKz0gXCI8YSBocmVmPSdcIiArcGVybWFsaW5rKyBcIicgY2xhc3M9J3JlYWRtb3JlJz5SZWFkIE1vcmUuLi48L2E+XCI7XG4gICAgICAgIH1cbiAgICAgICAgY29udGVudFRhZy5odG1sKGV4Y2VycHQpO1xuICAgICAgICBjb250ZW50VGFnLmFkZENsYXNzKCdleGNlcnB0LXJlYWR5Jyk7XG4gICAgICAgIGNvbnRlbnRMb2FkaW5nVGFnLmFkZENsYXNzKCdleGNlcnB0LXJlYWR5Jyk7XG4gICAgICB9KTtcbiAgICB9O1xuICAgIHNlbGYuaW5pdCgpO1xuICB9O1xuXHRcblx0JChmdW5jdGlvbigpIHtcblx0XHQkKCcjZm9vdGVyLCAjbWFpbicpLmFkZENsYXNzKCdsb2FkZWQnKTtcblx0XHQkKCcuc2l0ZS1uYXYtc3dpdGNoJykub24oJ2NsaWNrJywgdG9nZ2xlTWVudSk7XG5cdFx0JChkb2N1bWVudCkub24oJ2NsaWNrJywgY2xvc2VNZW51KTtcblx0XHQkKCcuc2l0ZS1tZW51Jykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHR9KTtcblx0XHQkKCcud2luZG93LW5hdiwgLmdvLWNvbW1lbnQnKS5vbignY2xpY2snLCBzY3JvbGx0b0VsZW1lbnQpO1xuXG5cdFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0ICAgICQoJyNsb2FkaW5nLWJhci13cmFwcGVyJykuZmFkZU91dCg1MDApO1xuXHQgIH0sIDMwMCk7XG5cdCAgXG5cdCAgaWYgKCQoJ2JvZHknKS5oYXNDbGFzcygndGFnLXBpeGl2JykgJiYgJChcImJvZHlcIikuaGFzQ2xhc3MoJ3BhZ2UnKSkge1xuICBcdCAgcGl4aXZBcmNoaXZlU3RhdCgpO1xuXHQgIH1cblx0ICBpZiAoRVhDRVJQVF9HRU5FUkFUT1JfRU5BQkxFKSB7XG4gICAgICBleGNlcnB0R2VuZXJhdG9yID0gbmV3IEV4Y2VycHRHZW5lcmF0b3IoJy5wb3N0LWxpc3QgLnBvc3QnKTtcbiAgICB9XG5cdCAgaWYgKEdPT0dMRV9DVVNUT01fU0VBUkNIX0VOQUJMRSkge1xuICBcdCAgY3VzdG9tU2VhcmNoID0gbmV3IEdvb2dsZUN1c3RvbVNlYXJjaCh7XG4gICAgXHQgIGFwaUtleTogR09PR0xFX0NVU1RPTV9TRUFSQ0hfQVBJX0tFWSxcbiAgICBcdCAgZW5naW5lSWQ6IEdPT0dMRV9DVVNUT01fU0VBUkNIX0VOR0lORV9JRFxuICBcdCAgfSk7XG5cdCAgfVxuXHR9KTtcblx0XHRcbn0pKGpRdWVyeSk7Il19
