var GoogleCustomSearch=function(e){var t=this,n="https://www.googleapis.com/customsearch/v1",a=10,o=$.extend({form:".searchform",input:".searchform .search_input",modal:"#modal-search",modalBody:"#modal-search .modal-body",overlay:"#modal-search .overlay",resultContainer:"#modal-search .results",closeButton:"#modal-search .close",nextButton:"#modal-search .next",prevButton:"#modal-search .prev",metadata:"#modal-search .meta",ajaxContent:"#modal-search .ajax-content, #modal-search .loading",loadingBar:"#modal-search .loading .bar",errorContainer:"#modal-search .modal-footer .error"},e);t.config=o,t.searchForm=$(o.form),t.searchInput=$(o.input),t.modal=$(o.modal),t.modalBody=$(o.modalBody),t.overlay=$(o.overlay),t.resultContainer=$(o.resultContainer),t.closeButton=$(o.closeButton),t.prevButton=$(o.prevButton),t.nextButton=$(o.nextButton),t.metadata=$(o.metadata),t.ajaxContent=$(o.ajaxContent),t.errorContainer=$(o.errorContainer),t.loadingBar=$(o.loadingBar),t.open=!1,t.queryText="",t.nav={next:-1,prev:-1,total:0,current:1},t.nextPage=function(){-1!==t.nav.next&&(o.onBeforeNextPage instanceof Function&&o.onBeforeNextPage.call(t),t.query(t.queryText,t.nav.next,function(e){o.onAfterNextPage instanceof Function&&o.onAfterNextPage.call(t,e)}))},t.prevPage=function(){-1!==t.nav.prev&&(o.onBeforePrevPage instanceof Function&&o.onBeforePrevPage.call(t),t.query(t.queryText,t.nav.prev,function(e){o.onAfterPrevPage instanceof Function&&o.onAfterPrevPage.call(t,e)}))},t.buildResults=function(e){var t="";return $.each(e,function(e,n){t+="<li>",t+="<a class='result' href='"+n.link+"'>",t+="<span class='title'>"+n.title+"</span>",t+="<span class='digest'>"+n.htmlSnippet.replace("<br>","")+"</span>",t+="<span class='icon icon-chevron-thin-right'></span>",t+="</a>",t+="</li>"}),t},t.buildMetadata=function(e){e.queries&&e.queries.request&&"0"!==e.queries.request[0].totalResults?(t.nav.current=e.queries.request[0].startIndex,t.nav.currentCount=e.queries.request[0].count,t.nav.total=parseInt(e.queries.request[0].totalResults),t.metadata.children(".total").html(t.nav.total),t.metadata.children(".range").html(t.nav.current+"-"+(t.nav.current+t.nav.currentCount-1)),t.metadata.show()):t.metadata.hide(),e.queries&&e.queries.nextPage?(t.nav.next=e.queries.nextPage[0].startIndex,t.nextButton.show()):(t.nav.next=-1,t.nextButton.hide()),e.queries&&e.queries.previousPage?(t.nav.prev=e.queries.previousPage[0].startIndex,t.prevButton.show()):(t.nav.prev=-1,t.prevButton.hide())},t.query=function(e,r,s){t.errorContainer.hide(),t.ajaxContent.removeClass("loaded"),$.get(n,{key:o.apiKey,cx:o.engineId,q:e,start:r,num:a},function(n,a){if("success"===a&&n.items&&n.items.length>0){var o=t.buildResults(n.items);t.resultContainer.html(o)}else{var r="";r="success"===a?'No result found for "'+e+'".':"timeout"===a?"Unfortunate timeout.":"Mysterious failure.",t.resultContainer.html(""),t.errorContainer.html(r),t.errorContainer.show()}t.buildMetadata(n),t.modalBody.scrollTop(0),t.ajaxContent.addClass("loaded"),s&&s(n)})},t.search=function(e){t.open||(t.modal.fadeIn(),$("body").addClass("modal-active")),t.searchInput.each(function(t,n){$(n).val(e)}),document.activeElement.blur(),t.query(e,1)},t.close=function(){t.open=!1,t.modal.fadeOut(),$("body").removeClass("modal-active")},t.init=function(){t.searchForm.each(function(e,n){$(n).on("submit",function(e){e.preventDefault(),t.queryText=$(this).children(".search_input").val(),t.search(t.queryText)})}),t.overlay.on("click",t.close),t.nextButton.on("click",t.nextPage),t.prevButton.on("click",t.prevPage),t.closeButton.on("click",t.close)},t.init()};!function(e){"use strict";var t=!0,n=!0,a="AIzaSyDGd5JJH7rR3sgS-JPYblwJ72GOsqzighc",o="017821029378163458527:msqkochcsj0",r={},s={},i=function(t){t.preventDefault();var n=e(this),a=t.data&&t.data.correction?t.data.correction:0;e("html, body").animate({scrollTop:e(n.attr("href")).offset().top-a},400)},l=function(t){t.stopPropagation(),e("body").removeClass("menu-open"),e(".site-nav-switch").removeClass("active")},c=function(t){t.stopPropagation(),e("body").toggleClass("menu-open"),e(".site-nav-switch").toggleClass("active")},u=function(){var t=e(".single .content ul").length,n=e(".single .content ul li").length;e("#pixiv-vol").text(t),e("#pixiv-artist-count").text(n)},d=function(t){var n=this;n.init=function(){e(t).each(function(){var t=e(this),n=t.find("h2.title > a").attr("href"),a=t.find("section.content"),o=t.find(".content-loading"),r=a.html(),s=/<!-- *more *-->(.|\n)*/i,i=r.replace(s,"");r.length!==i.length&&(i+="<a href='"+n+"' class='readmore'>Read More...</a>"),a.html(i),a.addClass("excerpt-ready"),o.addClass("excerpt-ready")})},n.init()};e(function(){e("#footer, #main").addClass("loaded"),e(".site-nav-switch").on("click",c),e(document).on("click",l),e(".site-menu").on("click",function(e){e.stopPropagation()}),e(".window-nav, .go-comment").on("click",i),setTimeout(function(){e("#loading-bar-wrapper").fadeOut(500)},300),e("body").hasClass("tag-pixiv")&&e("body").hasClass("page")&&u(),n&&(s=new d(".post-list .post")),t&&(r=new GoogleCustomSearch({apiKey:a,engineId:o}))})}(jQuery);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdvb2dsZS1jdXN0b20tc2VhcmNoLmpzIiwiYXBwLmpzIl0sIm5hbWVzIjpbIkdvb2dsZUN1c3RvbVNlYXJjaCIsIm9wdGlvbnMiLCJzZWxmIiwidGhpcyIsIkdPT0dMRV9DVVNUT01fU0VBUkNIX0VORFBPSU5UIiwiUEVSX1BBR0UiLCJjb25maWciLCIkIiwiZXh0ZW5kIiwiZm9ybSIsImlucHV0IiwibW9kYWwiLCJtb2RhbEJvZHkiLCJvdmVybGF5IiwicmVzdWx0Q29udGFpbmVyIiwiY2xvc2VCdXR0b24iLCJuZXh0QnV0dG9uIiwicHJldkJ1dHRvbiIsIm1ldGFkYXRhIiwiYWpheENvbnRlbnQiLCJsb2FkaW5nQmFyIiwiZXJyb3JDb250YWluZXIiLCJzZWFyY2hGb3JtIiwic2VhcmNoSW5wdXQiLCJvcGVuIiwicXVlcnlUZXh0IiwibmF2IiwibmV4dCIsInByZXYiLCJ0b3RhbCIsImN1cnJlbnQiLCJuZXh0UGFnZSIsIm9uQmVmb3JlTmV4dFBhZ2UiLCJGdW5jdGlvbiIsImNhbGwiLCJxdWVyeSIsImRhdGEiLCJvbkFmdGVyTmV4dFBhZ2UiLCJwcmV2UGFnZSIsIm9uQmVmb3JlUHJldlBhZ2UiLCJvbkFmdGVyUHJldlBhZ2UiLCJidWlsZFJlc3VsdHMiLCJodG1sIiwiZWFjaCIsImluZGV4Iiwicm93IiwibGluayIsInRpdGxlIiwiaHRtbFNuaXBwZXQiLCJyZXBsYWNlIiwiYnVpbGRNZXRhZGF0YSIsInF1ZXJpZXMiLCJyZXF1ZXN0IiwidG90YWxSZXN1bHRzIiwic3RhcnRJbmRleCIsImN1cnJlbnRDb3VudCIsImNvdW50IiwicGFyc2VJbnQiLCJjaGlsZHJlbiIsInNob3ciLCJoaWRlIiwicHJldmlvdXNQYWdlIiwiY2FsbGJhY2siLCJyZW1vdmVDbGFzcyIsImdldCIsImtleSIsImFwaUtleSIsImN4IiwiZW5naW5lSWQiLCJxIiwic3RhcnQiLCJudW0iLCJzdGF0dXMiLCJpdGVtcyIsImxlbmd0aCIsInJlc3VsdHMiLCJlcnJNc2ciLCJzY3JvbGxUb3AiLCJhZGRDbGFzcyIsInNlYXJjaCIsImZhZGVJbiIsImVsZW0iLCJ2YWwiLCJkb2N1bWVudCIsImFjdGl2ZUVsZW1lbnQiLCJibHVyIiwiY2xvc2UiLCJmYWRlT3V0IiwiaW5pdCIsIm9uIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsIkdPT0dMRV9DVVNUT01fU0VBUkNIX0VOQUJMRSIsIkVYQ0VSUFRfR0VORVJBVE9SX0VOQUJMRSIsIkdPT0dMRV9DVVNUT01fU0VBUkNIX0FQSV9LRVkiLCJHT09HTEVfQ1VTVE9NX1NFQVJDSF9FTkdJTkVfSUQiLCJjdXN0b21TZWFyY2giLCJleGNlcnB0R2VuZXJhdG9yIiwic2Nyb2xsdG9FbGVtZW50IiwiZSIsImNvcnJlY3Rpb24iLCJhbmltYXRlIiwiYXR0ciIsIm9mZnNldCIsInRvcCIsImNsb3NlTWVudSIsInN0b3BQcm9wYWdhdGlvbiIsInRvZ2dsZU1lbnUiLCJ0b2dnbGVDbGFzcyIsInBpeGl2QXJjaGl2ZVN0YXQiLCJ2b2wiLCJhcnRpc3RDb3VudCIsInRleHQiLCJFeGNlcnB0R2VuZXJhdG9yIiwic2VsZWN0b3IiLCJwb3N0IiwicGVybWFsaW5rIiwiZmluZCIsImNvbnRlbnRUYWciLCJjb250ZW50TG9hZGluZ1RhZyIsImNvbnRlbnQiLCJyZSIsImV4Y2VycHQiLCJzZXRUaW1lb3V0IiwiaGFzQ2xhc3MiLCJqUXVlcnkiXSwibWFwcGluZ3MiOiJBQUFBLEdBQUFBLG9CQUFBLFNBQUFDLEdBQ0EsR0FBQUMsR0FBQUMsS0FDQUMsRUFBQSw2Q0FDQUMsRUFBQSxHQUVBQyxFQUFBQyxFQUFBQyxRQUNBQyxLQUFBLGNBQ0FDLE1BQUEsNEJBQ0FDLE1BQUEsZ0JBQ0FDLFVBQUEsNEJBQ0FDLFFBQUEseUJBQ0FDLGdCQUFBLHlCQUNBQyxZQUFBLHVCQUNBQyxXQUFBLHNCQUNBQyxXQUFBLHNCQUNBQyxTQUFBLHNCQUNBQyxZQUFBLHNEQUNBQyxXQUFBLDhCQUNBQyxlQUFBLHNDQUNBcEIsRUFFQUMsR0FBQUksT0FBQUEsRUFFQUosRUFBQW9CLFdB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QUFBeUcsS0FBQUYsR0FDQXZHLEVBQUEsdUJBQUF5RyxLQUFBRCxJQUdBRSxFQUFBLFNBQUFDLEdBQ0EsR0FBQWhILEdBQUFDLElBQ0FELEdBQUFzRixLQUFBLFdBQ0FqRixFQUFBMkcsR0FBQXZFLEtBQUEsV0FDQSxHQUFBd0UsR0FBQTVHLEVBQUFKLE1BQ0FpSCxFQUFBRCxFQUFBRSxLQUFBLGdCQUFBZixLQUFBLFFBQ0FnQixFQUFBSCxFQUFBRSxLQUFBLG1CQUNBRSxFQUFBSixFQUFBRSxLQUFBLG9CQUNBRyxFQUFBRixFQUFBNUUsT0FDQStFLEVBQUEsMEJBQ0FDLEVBQUFGLEVBQUF2RSxRQUFBd0UsRUFBQSxHQUNBRCxHQUFBOUMsU0FBQWdELEVBQUFoRCxTQUNBZ0QsR0FBQSxZQUFBTixFQUFBLHVDQUVBRSxFQUFBNUUsS0FBQWdGLEdBQ0FKLEVBQUF4QyxTQUFBLGlCQUNBeUMsRUFBQXpDLFNBQUEsb0JBR0E1RSxFQUFBc0YsT0FHQWpGLEdBQUEsV0FDQUEsRUFBQSxrQkFBQXVFLFNBQUEsVUFDQXZFLEVBQUEsb0JBQUFrRixHQUFBLFFBQUFrQixHQUNBcEcsRUFBQTRFLFVBQUFNLEdBQUEsUUFBQWdCLEdBQ0FsRyxFQUFBLGNBQUFrRixHQUFBLFFBQUEsU0FBQVUsR0FDQUEsRUFBQU8sb0JBRUFuRyxFQUFBLDRCQUFBa0YsR0FBQSxRQUFBUyxHQUVBeUIsV0FBQSxXQUNBcEgsRUFBQSx3QkFBQWdGLFFBQUEsTUFDQSxLQUVBaEYsRUFBQSxRQUFBcUgsU0FBQSxjQUFBckgsRUFBQSxRQUFBcUgsU0FBQSxTQUNBZixJQUVBaEIsSUFDQUksRUFBQSxHQUFBZ0IsR0FBQSxxQkFFQXJCLElBQ0FJLEVBQUEsR0FBQWhHLHFCQUNBa0UsT0FBQTRCLEVBQ0ExQixTQUFBMkIsUUFLQThCIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBHb29nbGVDdXN0b21TZWFyY2ggPSBmdW5jdGlvbihvcHRpb25zKSB7XG4gIHZhciBzZWxmID0gdGhpcztcbiAgdmFyIEdPT0dMRV9DVVNUT01fU0VBUkNIX0VORFBPSU5UID0gXCJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9jdXN0b21zZWFyY2gvdjFcIjtcbiAgdmFyIFBFUl9QQUdFID0gMTA7IC8vIG11c3QgYmUgYmV0d2VlbiAxLTEwXG4gIFxuICB2YXIgY29uZmlnID0gJC5leHRlbmQoe1xuICAgIGZvcm06IFwiLnNlYXJjaGZvcm1cIixcbiAgICBpbnB1dDogXCIuc2VhcmNoZm9ybSAuc2VhcmNoX2lucHV0XCIsXG4gICAgbW9kYWw6IFwiI21vZGFsLXNlYXJjaFwiLFxuICAgIG1vZGFsQm9keTogXCIjbW9kYWwtc2VhcmNoIC5tb2RhbC1ib2R5XCIsXG4gICAgb3ZlcmxheTogXCIjbW9kYWwtc2VhcmNoIC5vdmVybGF5XCIsXG4gICAgcmVzdWx0Q29udGFpbmVyOiBcIiNtb2RhbC1zZWFyY2ggLnJlc3VsdHNcIixcbiAgICBjbG9zZUJ1dHRvbjogXCIjbW9kYWwtc2VhcmNoIC5jbG9zZVwiLFxuICAgIG5leHRCdXR0b246IFwiI21vZGFsLXNlYXJjaCAubmV4dFwiLFxuICAgIHByZXZCdXR0b246IFwiI21vZGFsLXNlYXJjaCAucHJldlwiLFxuICAgIG1ldGFkYXRhOiBcIiNtb2RhbC1zZWFyY2ggLm1ldGFcIixcbiAgICBhamF4Q29udGVudDogXCIjbW9kYWwtc2VhcmNoIC5hamF4LWNvbnRlbnQsICNtb2RhbC1zZWFyY2ggLmxvYWRpbmdcIixcbiAgICBsb2FkaW5nQmFyOiBcIiNtb2RhbC1zZWFyY2ggLmxvYWRpbmcgLmJhclwiLFxuICAgIGVycm9yQ29udGFpbmVyOiBcIiNtb2RhbC1zZWFyY2ggLm1vZGFsLWZvb3RlciAuZXJyb3JcIlxuICB9LCBvcHRpb25zKTtcbiAgXG4gIHNlbGYuY29uZmlnID0gY29uZmlnO1xuICBcbiAgc2VsZi5zZWFyY2hGb3JtID0gJChjb25maWcuZm9ybSk7XG4gIHNlbGYuc2VhcmNoSW5wdXQgPSAkKGNvbmZpZy5pbnB1dCk7XG4gIHNlbGYubW9kYWwgPSAkKGNvbmZpZy5tb2RhbCk7XG4gIHNlbGYubW9kYWxCb2R5ID0gJChjb25maWcubW9kYWxCb2R5KTtcbiAgc2VsZi5vdmVybGF5ID0gJChjb25maWcub3ZlcmxheSk7XG4gIHNlbGYucmVzdWx0Q29udGFpbmVyID0gJChjb25maWcucmVzdWx0Q29udGFpbmVyKTtcbiAgc2VsZi5jbG9zZUJ1dHRvbiA9ICQoY29uZmlnLmNsb3NlQnV0dG9uKTtcbiAgc2VsZi5wcmV2QnV0dG9uID0gJChjb25maWcucHJldkJ1dHRvbik7XG4gIHNlbGYubmV4dEJ1dHRvbiA9ICQoY29uZmlnLm5leHRCdXR0b24pO1xuICBzZWxmLm1ldGFkYXRhID0gJChjb25maWcubWV0YWRhdGEpO1xuICBzZWxmLmFqYXhDb250ZW50ID0gJChjb25maWcuYWpheENvbnRlbnQpO1xuICBzZWxmLmVycm9yQ29udGFpbmVyID0gJChjb25maWcuZXJyb3JDb250YWluZXIpO1xuICBzZWxmLmxvYWRpbmdCYXIgPSAkKGNvbmZpZy5sb2FkaW5nQmFyKTtcbiAgXG4gIHNlbGYub3BlbiA9IGZhbHNlO1xuICBzZWxmLnF1ZXJ5VGV4dCA9IFwiXCI7XG4gIHNlbGYubmF2ID0ge1xuICAgIG5leHQ6IC0xLFxuICAgIHByZXY6IC0xLFxuICAgIHRvdGFsOiAwLFxuICAgIGN1cnJlbnQ6IDFcbiAgfTtcbiAgXG4gIC8qKlxuICAgKiBGZXRjaCBuZXh0IHBhZ2Ugb2YgcmVzdWx0cyAoaWYgZXhpc3RzKVxuICAgKiBubyBwYXJhbVxuICAgKi9cbiAgc2VsZi5uZXh0UGFnZSA9IGZ1bmN0aW9uKCkge1xuICAgIGlmIChzZWxmLm5hdi5uZXh0ICE9PSAtMSkge1xuICAgICAgaWYgKGNvbmZpZy5vbkJlZm9yZU5leHRQYWdlIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcbiAgICAgICAgY29uZmlnLm9uQmVmb3JlTmV4dFBhZ2UuY2FsbChzZWxmKTtcbiAgICAgIH1cbiAgICAgIHNlbGYucXVlcnkoc2VsZi5xdWVyeVRleHQsIHNlbGYubmF2Lm5leHQsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgaWYgKGNvbmZpZy5vbkFmdGVyTmV4dFBhZ2UgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xuICAgICAgICAgIGNvbmZpZy5vbkFmdGVyTmV4dFBhZ2UuY2FsbChzZWxmLCBkYXRhKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9O1xuICBcbiAgLyoqXG4gICAqIEZldGNoIHByZXZpb3VzIHBhZ2Ugb2YgcmVzdWx0cyAoaWYgZXhpc3RzKVxuICAgKiBubyBwYXJhbVxuICAgKi9cbiAgc2VsZi5wcmV2UGFnZSA9IGZ1bmN0aW9uKCkge1xuICAgIGlmIChzZWxmLm5hdi5wcmV2ICE9PSAtMSkge1xuICAgICAgaWYgKGNvbmZpZy5vbkJlZm9yZVByZXZQYWdlIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcbiAgICAgICAgY29uZmlnLm9uQmVmb3JlUHJldlBhZ2UuY2FsbChzZWxmKTtcbiAgICAgIH1cbiAgICAgIHNlbGYucXVlcnkoc2VsZi5xdWVyeVRleHQsIHNlbGYubmF2LnByZXYsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgaWYgKGNvbmZpZy5vbkFmdGVyUHJldlBhZ2UgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xuICAgICAgICAgIGNvbmZpZy5vbkFmdGVyUHJldlBhZ2UuY2FsbChzZWxmLCBkYXRhKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9O1xuICBcbiAgLyoqXG4gICAqIEdlbmVyYXRlIHJlc3VsdCBsaXN0IGh0bWxcbiAgICogQHBhcmFtIGRhdGEgOiAoYXJyYXkpIHJlc3VsdCBpdGVtc1xuICAgKi9cbiAgc2VsZi5idWlsZFJlc3VsdHMgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgdmFyIGh0bWwgPSBcIlwiO1xuICAgICQuZWFjaChkYXRhLCBmdW5jdGlvbihpbmRleCwgcm93KSB7XG4gICAgICBodG1sICs9IFwiPGxpPlwiO1xuICAgICAgaHRtbCArPSAgIFwiPGEgY2xhc3M9J3Jlc3VsdCcgaHJlZj0nXCIgK3Jvdy5saW5rKyBcIic+XCI7XG4gICAgICBodG1sICs9ICAgICBcIjxzcGFuIGNsYXNzPSd0aXRsZSc+XCIgK3Jvdy50aXRsZSsgXCI8L3NwYW4+XCI7XG4gICAgICBodG1sICs9ICAgICBcIjxzcGFuIGNsYXNzPSdkaWdlc3QnPlwiICtyb3cuaHRtbFNuaXBwZXQucmVwbGFjZSgnPGJyPicsJycpKyBcIjwvc3Bhbj5cIjtcbiAgICAgIGh0bWwgKz0gICAgIFwiPHNwYW4gY2xhc3M9J2ljb24gaWNvbi1jaGV2cm9uLXRoaW4tcmlnaHQnPjwvc3Bhbj5cIjtcbiAgICAgIGh0bWwgKz0gICBcIjwvYT5cIjtcbiAgICAgIGh0bWwgKz0gXCI8L2xpPlwiO1xuICAgIH0pO1xuICAgIHJldHVybiBodG1sO1xuICB9O1xuICBcbiAgLyoqXG4gICAqIEdlbmVyYXRlIG1ldGFkYXRhIGFmdGVyIGEgc3VjY2Vzc2Z1bCBxdWVyeVxuICAgKiBAcGFyYW0gZGF0YSA6IChvYmplY3QpIHRoZSByYXcgZ29vZ2xlIGN1c3RvbSBzZWFyY2ggcmVzcG9uc2UgZGF0YVxuICAgKi9cbiAgc2VsZi5idWlsZE1ldGFkYXRhID0gZnVuY3Rpb24oZGF0YSkge1xuICAgIGlmIChkYXRhLnF1ZXJpZXMgJiYgZGF0YS5xdWVyaWVzLnJlcXVlc3QgJiYgZGF0YS5xdWVyaWVzLnJlcXVlc3RbMF0udG90YWxSZXN1bHRzICE9PSAnMCcpIHtcbiAgICAgIHNlbGYubmF2LmN1cnJlbnQgPSBkYXRhLnF1ZXJpZXMucmVxdWVzdFswXS5zdGFydEluZGV4O1xuICAgICAgc2VsZi5uYXYuY3VycmVudENvdW50ID0gZGF0YS5xdWVyaWVzLnJlcXVlc3RbMF0uY291bnQ7XG4gICAgICBzZWxmLm5hdi50b3RhbCA9IHBhcnNlSW50KGRhdGEucXVlcmllcy5yZXF1ZXN0WzBdLnRvdGFsUmVzdWx0cyk7XG4gICAgICBzZWxmLm1ldGFkYXRhLmNoaWxkcmVuKCcudG90YWwnKS5odG1sKHNlbGYubmF2LnRvdGFsKTtcbiAgICAgIHNlbGYubWV0YWRhdGEuY2hpbGRyZW4oJy5yYW5nZScpLmh0bWwoc2VsZi5uYXYuY3VycmVudCArIFwiLVwiICsgKHNlbGYubmF2LmN1cnJlbnQrc2VsZi5uYXYuY3VycmVudENvdW50LTEpKTtcbiAgICAgIHNlbGYubWV0YWRhdGEuc2hvdygpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHNlbGYubWV0YWRhdGEuaGlkZSgpO1xuICAgIH1cbiAgICBpZiAoZGF0YS5xdWVyaWVzICYmIGRhdGEucXVlcmllcy5uZXh0UGFnZSkge1xuICAgICAgc2VsZi5uYXYubmV4dCA9IGRhdGEucXVlcmllcy5uZXh0UGFnZVswXS5zdGFydEluZGV4O1xuICAgICAgc2VsZi5uZXh0QnV0dG9uLnNob3coKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBzZWxmLm5hdi5uZXh0ID0gLTE7XG4gICAgICBzZWxmLm5leHRCdXR0b24uaGlkZSgpO1xuICAgIH1cbiAgICBpZiAoZGF0YS5xdWVyaWVzICYmIGRhdGEucXVlcmllcy5wcmV2aW91c1BhZ2UpIHtcbiAgICAgIHNlbGYubmF2LnByZXYgPSBkYXRhLnF1ZXJpZXMucHJldmlvdXNQYWdlWzBdLnN0YXJ0SW5kZXg7XG4gICAgICBzZWxmLnByZXZCdXR0b24uc2hvdygpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHNlbGYubmF2LnByZXYgPSAtMTtcbiAgICAgIHNlbGYucHJldkJ1dHRvbi5oaWRlKCk7XG4gICAgfVxuICB9O1xuICBcbiAgXG4gIC8qKlxuICAgKiBTZW5kIGEgR0VUIHJlcXVlc3QgdG8gR29vZ2xlIEN1c3RvbSBTZWFyY2ggQVBJXG4gICAqIEBwYXJhbSBxdWVyeVRleHQgOiAoc3RyaW5nKSB0aGUgcXVlcnkgdGV4dFxuICAgKi9cbiAgc2VsZi5xdWVyeSA9IGZ1bmN0aW9uKHF1ZXJ5VGV4dCwgc3RhcnRJbmRleCwgY2FsbGJhY2spIHtcbiAgICBzZWxmLmVycm9yQ29udGFpbmVyLmhpZGUoKTtcbiAgICBzZWxmLmFqYXhDb250ZW50LnJlbW92ZUNsYXNzKCdsb2FkZWQnKTtcbiAgICAkLmdldChHT09HTEVfQ1VTVE9NX1NFQVJDSF9FTkRQT0lOVCwge1xuICAgICAga2V5OiBjb25maWcuYXBpS2V5LFxuICAgICAgY3g6IGNvbmZpZy5lbmdpbmVJZCxcbiAgICAgIHE6IHF1ZXJ5VGV4dCxcbiAgICAgIHN0YXJ0OiBzdGFydEluZGV4LFxuICAgICAgbnVtOiBQRVJfUEFHRVxuICAgIH0sIGZ1bmN0aW9uKGRhdGEsIHN0YXR1cykge1xuICAgICAgaWYgKHN0YXR1cyA9PT0gJ3N1Y2Nlc3MnICYmIGRhdGEuaXRlbXMgJiYgZGF0YS5pdGVtcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHZhciByZXN1bHRzID0gc2VsZi5idWlsZFJlc3VsdHMoZGF0YS5pdGVtcyk7IFxuICAgICAgICBzZWxmLnJlc3VsdENvbnRhaW5lci5odG1sKHJlc3VsdHMpOyAgICAgICBcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICB2YXIgZXJyTXNnID0gXCJcIjtcbiAgICAgICAgaWYgKHN0YXR1cyA9PT0gXCJzdWNjZXNzXCIpIGVyck1zZyA9IFwiTm8gcmVzdWx0IGZvdW5kIGZvciBcXFwiXCIgK3F1ZXJ5VGV4dCsgXCJcXFwiLlwiO1xuICAgICAgICBlbHNlIGlmIChzdGF0dXMgPT09IFwidGltZW91dFwiKSBlcnJNc2cgPSBcIlVuZm9ydHVuYXRlIHRpbWVvdXQuXCI7XG4gICAgICAgIGVsc2UgZXJyTXNnID0gXCJNeXN0ZXJpb3VzIGZhaWx1cmUuXCI7XG4gICAgICAgIHNlbGYucmVzdWx0Q29udGFpbmVyLmh0bWwoXCJcIik7XG4gICAgICAgIHNlbGYuZXJyb3JDb250YWluZXIuaHRtbChlcnJNc2cpO1xuICAgICAgICBzZWxmLmVycm9yQ29udGFpbmVyLnNob3coKTtcbiAgICAgIH1cbiAgICAgIHNlbGYuYnVpbGRNZXRhZGF0YShkYXRhKTtcbiAgICAgIHNlbGYubW9kYWxCb2R5LnNjcm9sbFRvcCgwKTtcbiAgICAgIHNlbGYuYWpheENvbnRlbnQuYWRkQ2xhc3MoJ2xvYWRlZCcpO1xuICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgIGNhbGxiYWNrKGRhdGEpO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuICBcbiAgLyoqXG4gICAqIFNlYXJjaGZvcm0gc3VibWl0IGV2ZW50IGhhbmRsZXJcbiAgICogQHBhcmFtIHF1ZXJ5VGV4dCA6IChzdHJpbmcpIHRoZSBxdWVyeSB0ZXh0XG4gICAqL1xuICBzZWxmLnNlYXJjaCA9IGZ1bmN0aW9uKHF1ZXJ5VGV4dCkge1xuICAgIC8vIFVJIHVwZGF0ZVxuICAgIGlmICghc2VsZi5vcGVuKSB7XG4gICAgICBzZWxmLm1vZGFsLmZhZGVJbigpO1xuICAgICAgJCgnYm9keScpLmFkZENsYXNzKCdtb2RhbC1hY3RpdmUnKTtcbiAgICB9XG4gICAgc2VsZi5zZWFyY2hJbnB1dC5lYWNoKGZ1bmN0aW9uKGluZGV4LGVsZW0pIHtcbiAgICAgICQoZWxlbSkudmFsKHF1ZXJ5VGV4dCk7XG4gICAgfSk7XG4gICAgZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5ibHVyKCk7XG4gICAgLy8gQWpheCBHRVRcbiAgICBzZWxmLnF1ZXJ5KHF1ZXJ5VGV4dCwgMSk7XG4gIH07XG4gIFxuICAvKipcbiAgICogQ2xvc2UgdGhlIG1vZGFsLCByZXN1bWUgYm9keSBzY3JvbGxpbmdcbiAgICogbm8gcGFyYW1cbiAgICovXG4gIHNlbGYuY2xvc2UgPSBmdW5jdGlvbigpIHtcbiAgICBzZWxmLm9wZW4gPSBmYWxzZTtcbiAgICBzZWxmLm1vZGFsLmZhZGVPdXQoKTtcbiAgICAkKCdib2R5JykucmVtb3ZlQ2xhc3MoJ21vZGFsLWFjdGl2ZScpO1xuICB9O1xuICBcbiAgLyoqXG4gICAqIFJlZ2lzdGVyIGV2ZW50IGhhbmRsZXJzXG4gICAqIG5vIHBhcmFtXG4gICAqL1xuICBzZWxmLmluaXQgPSBmdW5jdGlvbigpIHtcbiAgICBzZWxmLnNlYXJjaEZvcm0uZWFjaChmdW5jdGlvbihpbmRleCxlbGVtKSB7XG4gICAgICAkKGVsZW0pLm9uKCdzdWJtaXQnLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBzZWxmLnF1ZXJ5VGV4dCA9ICQodGhpcykuY2hpbGRyZW4oJy5zZWFyY2hfaW5wdXQnKS52YWwoKTtcbiAgICAgICAgc2VsZi5zZWFyY2goc2VsZi5xdWVyeVRleHQpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgc2VsZi5vdmVybGF5Lm9uKCdjbGljaycsIHNlbGYuY2xvc2UpO1xuICAgIHNlbGYubmV4dEJ1dHRvbi5vbignY2xpY2snLCBzZWxmLm5leHRQYWdlKTtcbiAgICBzZWxmLnByZXZCdXR0b24ub24oJ2NsaWNrJywgc2VsZi5wcmV2UGFnZSk7XG4gICAgc2VsZi5jbG9zZUJ1dHRvbi5vbignY2xpY2snLCBzZWxmLmNsb3NlKTtcbiAgfTtcbiAgXG4gIHNlbGYuaW5pdCgpO1xufTsiLCIoZnVuY3Rpb24oJCkge1xuXHRcblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFxuXHQvLyBvcHRpb25zXG5cdHZhciBHT09HTEVfQ1VTVE9NX1NFQVJDSF9FTkFCTEUgPSB0cnVlO1xuXHR2YXIgRVhDRVJQVF9HRU5FUkFUT1JfRU5BQkxFID0gdHJ1ZTtcblx0dmFyIEdPT0dMRV9DVVNUT01fU0VBUkNIX0FQSV9LRVkgPSBcIkFJemFTeURHZDVKSkg3clIzc2dTLUpQWWJsd0o3MkdPc3F6aWdoY1wiO1xuXHR2YXIgR09PR0xFX0NVU1RPTV9TRUFSQ0hfRU5HSU5FX0lEID0gXCIwMTc4MjEwMjkzNzgxNjM0NTg1Mjc6bXNxa29jaGNzajBcIjtcblxuXG5cdHZhciBjdXN0b21TZWFyY2ggPSB7fTtcblx0dmFyIGV4Y2VycHRHZW5lcmF0b3IgPSB7fTtcbiAgXG4gIHZhciBzY3JvbGx0b0VsZW1lbnQgPSBmdW5jdGlvbihlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHZhciBzZWxmID0gJCh0aGlzKSxcbiAgICAgICAgY29ycmVjdGlvbiA9IGUuZGF0YSA/IGUuZGF0YS5jb3JyZWN0aW9uID8gZS5kYXRhLmNvcnJlY3Rpb24gOiAwIDogMDtcbiAgICAkKCdodG1sLCBib2R5JykuYW5pbWF0ZSh7J3Njcm9sbFRvcCc6ICQoc2VsZi5hdHRyKCdocmVmJykpLm9mZnNldCgpLnRvcCAtIGNvcnJlY3Rpb24gfSwgNDAwKTtcbiAgfTtcblx0XG4gIHZhciBjbG9zZU1lbnUgPSBmdW5jdGlvbihlKSB7XG5cdCAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAkKCdib2R5JykucmVtb3ZlQ2xhc3MoJ21lbnUtb3BlbicpO1xuXHRcdCQoJy5zaXRlLW5hdi1zd2l0Y2gnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gIH07XG4gIFxuICB2YXIgdG9nZ2xlTWVudSA9IGZ1bmN0aW9uKGUpIHtcblx0ICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHQgICQoJ2JvZHknKS50b2dnbGVDbGFzcygnbWVudS1vcGVuJyk7XG4gICAgJCgnLnNpdGUtbmF2LXN3aXRjaCcpLnRvZ2dsZUNsYXNzKCdhY3RpdmUnKTtcbiAgfTtcbiAgXG4gIHZhciBwaXhpdkFyY2hpdmVTdGF0ID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHZvbCA9ICQoXCIuc2luZ2xlIC5jb250ZW50IHVsXCIpLmxlbmd0aDtcbiAgICB2YXIgYXJ0aXN0Q291bnQgPSAkKFwiLnNpbmdsZSAuY29udGVudCB1bCBsaVwiKS5sZW5ndGg7XG4gICAgJChcIiNwaXhpdi12b2xcIikudGV4dCh2b2wpO1xuICAgICQoXCIjcGl4aXYtYXJ0aXN0LWNvdW50XCIpLnRleHQoYXJ0aXN0Q291bnQpO1xuICB9O1xuICBcbiAgdmFyIEV4Y2VycHRHZW5lcmF0b3IgPSBmdW5jdGlvbihzZWxlY3Rvcikge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBzZWxmLmluaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICQoc2VsZWN0b3IpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBwb3N0ID0gJCh0aGlzKTtcbiAgICAgICAgdmFyIHBlcm1hbGluayA9IHBvc3QuZmluZCgnaDIudGl0bGUgPiBhJykuYXR0cignaHJlZicpO1xuICAgICAgICB2YXIgY29udGVudFRhZyA9IHBvc3QuZmluZCgnc2VjdGlvbi5jb250ZW50Jyk7XG4gICAgICAgIHZhciBjb250ZW50TG9hZGluZ1RhZyA9IHBvc3QuZmluZCgnLmNvbnRlbnQtbG9hZGluZycpO1xuICAgICAgICB2YXIgY29udGVudCA9IGNvbnRlbnRUYWcuaHRtbCgpO1xuICAgICAgICB2YXIgcmUgPSAvPCEtLSAqbW9yZSAqLS0+KC58XFxuKSovaTtcbiAgICAgICAgdmFyIGV4Y2VycHQgPSBjb250ZW50LnJlcGxhY2UocmUsXCJcIik7XG4gICAgICAgIGlmIChjb250ZW50Lmxlbmd0aCAhPT0gZXhjZXJwdC5sZW5ndGgpIHtcbiAgICAgICAgICBleGNlcnB0ICs9IFwiPGEgaHJlZj0nXCIgK3Blcm1hbGluaysgXCInIGNsYXNzPSdyZWFkbW9yZSc+UmVhZCBNb3JlLi4uPC9hPlwiO1xuICAgICAgICB9XG4gICAgICAgIGNvbnRlbnRUYWcuaHRtbChleGNlcnB0KTtcbiAgICAgICAgY29udGVudFRhZy5hZGRDbGFzcygnZXhjZXJwdC1yZWFkeScpO1xuICAgICAgICBjb250ZW50TG9hZGluZ1RhZy5hZGRDbGFzcygnZXhjZXJwdC1yZWFkeScpO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICBzZWxmLmluaXQoKTtcbiAgfTtcblx0XG5cdCQoZnVuY3Rpb24oKSB7XG5cdFx0JCgnI2Zvb3RlciwgI21haW4nKS5hZGRDbGFzcygnbG9hZGVkJyk7XG5cdFx0JCgnLnNpdGUtbmF2LXN3aXRjaCcpLm9uKCdjbGljaycsIHRvZ2dsZU1lbnUpO1xuXHRcdCQoZG9jdW1lbnQpLm9uKCdjbGljaycsIGNsb3NlTWVudSk7XG5cdFx0JCgnLnNpdGUtbWVudScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0fSk7XG5cdFx0JCgnLndpbmRvdy1uYXYsIC5nby1jb21tZW50Jykub24oJ2NsaWNrJywgc2Nyb2xsdG9FbGVtZW50KTtcblxuXHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdCAgICAkKCcjbG9hZGluZy1iYXItd3JhcHBlcicpLmZhZGVPdXQoNTAwKTtcblx0ICB9LCAzMDApO1xuXHQgIFxuXHQgIGlmICgkKCdib2R5JykuaGFzQ2xhc3MoJ3RhZy1waXhpdicpICYmICQoXCJib2R5XCIpLmhhc0NsYXNzKCdwYWdlJykpIHtcbiAgXHQgIHBpeGl2QXJjaGl2ZVN0YXQoKTtcblx0ICB9XG5cdCAgaWYgKEVYQ0VSUFRfR0VORVJBVE9SX0VOQUJMRSkge1xuICAgICAgZXhjZXJwdEdlbmVyYXRvciA9IG5ldyBFeGNlcnB0R2VuZXJhdG9yKCcucG9zdC1saXN0IC5wb3N0Jyk7XG4gICAgfVxuXHQgIGlmIChHT09HTEVfQ1VTVE9NX1NFQVJDSF9FTkFCTEUpIHtcbiAgXHQgIGN1c3RvbVNlYXJjaCA9IG5ldyBHb29nbGVDdXN0b21TZWFyY2goe1xuICAgIFx0ICBhcGlLZXk6IEdPT0dMRV9DVVNUT01fU0VBUkNIX0FQSV9LRVksXG4gICAgXHQgIGVuZ2luZUlkOiBHT09HTEVfQ1VTVE9NX1NFQVJDSF9FTkdJTkVfSURcbiAgXHQgIH0pO1xuXHQgIH1cblx0fSk7XG5cdFx0XG59KShqUXVlcnkpOyJdfQ==
